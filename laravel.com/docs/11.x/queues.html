<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from laravel.com/docs/11.x/queues by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 03:14:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">

        <title>Queues - Laravel 11.x - The PHP Framework For Web Artisans</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

        <link rel="canonical" href="queues.html">
    
    <!-- Primary Meta Tags -->
    <meta name="title" content="Laravel - The PHP Framework For Web Artisans">
    <meta name="description" content="Laravel is a PHP web application framework with expressive, elegant syntax. We’ve already laid the foundation — freeing you to create without sweating the small things.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://laravel.com/">
    <meta property="og:title" content="Laravel - The PHP Framework For Web Artisans">
    <meta property="og:description" content="Laravel is a PHP web application framework with expressive, elegant syntax. We’ve already laid the foundation — freeing you to create without sweating the small things.">
    <meta property="og:image" content="../../img/og-image.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://laravel.com/">
    <meta property="twitter:title" content="Laravel - The PHP Framework For Web Artisans">
    <meta property="twitter:description" content="Laravel is a PHP web application framework with expressive, elegant syntax. We’ve already laid the foundation — freeing you to create without sweating the small things.">
    <meta property="twitter:image" content="../../img/og-image.jpg">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://laravel.com/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://laravel.com/img/favicon/safari-pinned-tab.svg" color="#ff2d20">
    <link rel="shortcut icon" href="https://laravel.com/img/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#ff2d20">
    <meta name="msapplication-config" content="https://laravel.com/img/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="color-scheme" content="light">

    <link rel="preconnect" href="https://e3mirnpjh5-dsn.algolia.net/" crossorigin />

    <link rel="stylesheet" href="../../../use.typekit.net/ins2wgm.css">
    <link rel="preload" as="style" href="../../build/assets/app-6e52703b.css" /><link rel="modulepreload" href="../../build/assets/app-70a5a3a6.js" /><link rel="modulepreload" href="../../build/assets/docs-45166933.js" /><link rel="stylesheet" href="../../build/assets/app-6e52703b.css" /><script type="module" src="../../build/assets/app-70a5a3a6.js"></script><script type="module" src="../../build/assets/docs-45166933.js"></script>
            <!-- Fathom - beautiful, simple website analytics -->
        <script src="../../../cdn.usefathom.com/script.js" data-site="DVMEKBYF" defer></script>
        <!-- / Fathom -->

        <!-- Clearbit -->
        <script async src="../../../tag.clearbitscripts.com/v1/pk_97d2bf69f817feb07be42fcda1460119/tags.js" referrerpolicy="strict-origin-when-cross-origin"></script>
    
    
    <script>
        const alwaysLightMode = false;
    </script>

    <script>
    function updateTheme() {
        if (!('theme' in localStorage)) {
            localStorage.theme = 'system';
        }

        switch (localStorage.theme) {
            case 'system':
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    document.documentElement.setAttribute('data-theme', 'light');
                }

                document.documentElement.setAttribute('color-theme', 'system');
                break;

            case 'dark':
                document.documentElement.classList.add('dark');
                document.documentElement.setAttribute('color-theme', 'dark');
                document.documentElement.setAttribute('data-theme', 'dark');
                break;

            case 'light':
                document.documentElement.classList.remove('dark');
                document.documentElement.setAttribute('color-theme', 'light');
                document.documentElement.setAttribute('data-theme', 'light');
                break;
        }

        updateThemeAndSchemeColor();
    }

    function updateThemeAndSchemeColor() {
        if (! alwaysLightMode) {
            if (document.documentElement.classList.contains('dark')) {
                document.querySelector('meta[name="color-scheme"]').setAttribute('content', 'dark');
                document.querySelector('meta[name="theme-color"]').setAttribute('content', '#171923');

                return;
            }

            document.querySelector('meta[name="color-scheme"]').setAttribute('content', 'light');
            document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff');
        }
    }

    updateTheme();
</script>

    </head>
<body
    x-data="{
        navIsOpen: false,
    }"
    class="w-full h-full font-sans antialiased text-gray-900 language-php"
    data-instant-intensity="0"
>

    <a
    id="skip-to-content-link"
    href="#main-content"
    class="absolute bg-gray-100 px-4 py-2 top-3 left-3 text-gray-700 shadow-xl"
>
    Skip to content
</a>

    <div class="hidden lg:flex items-center justify-center bg-gradient-to-b from-red-500 to-red-600 p-2 text-center text-white text-sm h-9">
    <template id="news-herd">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" stroke-linecap="round" fill="none" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M3 4m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1z" />
              <path d="M7 8v1" />
              <path d="M17 8v1" />
              <path d="M12.5 4c-.654 1.486 -1.26 3.443 -1.5 9h2.5c-.19 2.867 .094 5.024 .5 7" />
              <path d="M7 15.5c3.667 2 6.333 2 10 0" />
            </svg>
        </div>

        <div class="mt-px ml-1">
            Get started with PHP and Laravel faster than ever using <a href="https://herd.laravel.com/" class="underline">Laravel Herd</a>.
        </div>
    </template>

    <template id="news-laracon">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>

        <div class="mt-px ml-1">
            Join us in Dallas, TX! Tickets are now available for <a href="https://laracon.us/" class="underline">Laracon US</a>.
        </div>
    </template>

    <template id="news-laracon-in">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>

        <div class="mt-px ml-1">
            Let's go to India! Tickets are now available for <a href="https://laracon.in/" class="underline">Laracon IN</a>.
        </div>
    </template>

    <template id="news-laracon-eu">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>

        <div class="mt-px ml-1">
            Let's go to Europe! Tickets are now available for <a href="https://laracon.eu/" class="underline">Laracon EU</a>.
        </div>
    </template>

    <template id="news-laracon-au">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>

        <div class="mt-px ml-1">
            Let's go down under! Tickets are now available for <a href="https://laracon.au/" class="underline">Laracon AU</a>.
        </div>
    </template>

    <template id="news-forge">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div>

        <div class="mt-px ml-1">
            Servers with PHP 8.3 are now available for provisioning via <a href="https://forge.laravel.com/" class="underline">Laravel Forge</a>.
        </div>
    </template>

    <template id="news-vapor">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg></div>

        <div class="mt-px ml-1">
            Deploy Laravel with the infinite scale of serverless using <a href="https://vapor.laravel.com/" class="underline">Laravel Vapor</a>.
        </div>
    </template>

    <template id="news-cloud">
        

        <div class="mt-px ml-1">
            Join the waitlist for <a href="https://cloud.laravel.com/" class="underline">Laravel Cloud</a>, the future of shipping.
        </div>
    </template>

    <template id="news-pulse">
        <div><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg></div>

        <div class="mt-px ml-1">
            How's your health? Check your application's vital signs using <a href="https://pulse.laravel.com/" class="underline">Laravel Pulse</a>.
        </div>
    </template>

    <template id="news-reverb">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M3.707 6.293l2.586 -2.586a1 1 0 0 1 1.414 0l5.586 5.586a1 1 0 0 1 0 1.414l-2.586 2.586a1 1 0 0 1 -1.414 0l-5.586 -5.586a1 1 0 0 1 0 -1.414z" />
              <path d="M6 10l-3 3l3 3l3 -3" />
              <path d="M10 6l3 -3l3 3l-3 3" />
              <path d="M12 12l1.5 1.5" />
              <path d="M14.5 17a2.5 2.5 0 0 0 2.5 -2.5" />
              <path d="M15 21a6 6 0 0 0 6 -6" />
            </svg>
        </div>

        <div class="mt-px ml-1">
            Incoming transmission received. <a href="https://reverb.laravel.com/" class="underline">Laravel Reverb</a> is now available!
        </div>
    </template>

    <template id="news-nova">
        <div>
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"></path>
            </svg>
        </div>

        <div class="mt-px ml-1">
            Take your administration backend to another dimension with <a href="https://nova.laravel.com/" class="underline">Laravel Nova</a>.
        </div>
    </template>

    <template id="news-careers">
        <div>
            <svg class="w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z" />
            </svg>
        </div>

        <div class="mt-px ml-1">
            Laravel is hiring! <a href="https://laravel.com/careers" class="underline">Help us build the future of Laravel</a>.
        </div>

    </template>
</div>
<script>
    const activeNewsTemplate = document.getElementById(
        'news-'+JSON.parse('[\u0022cloud\u0022]')[Math.floor(Math.random() * 1)]
    )

    activeNewsTemplate.replaceWith(activeNewsTemplate.content)
</script>

    <div class="relative dark:bg-dark-700" id="docsScreen">
        <div class="relative lg:flex lg:items-start">
            <aside class="hidden fixed top-0 bottom-0 left-0 z-20 w-16 bg-gradient-to-b from-gray-100 to-white transition-all duration-300 lg:sticky lg:w-80 lg:shrink-0 lg:flex lg:flex-col lg:justify-end lg:items-end 2xl:max-w-lg 2xl:w-full dark:from-dark-800 dark:to-dark-700">
                <div class="relative max-h-screen overflow-auto flex-1 flex flex-col xl:w-80">
                    <a href="https://laravel.com/" class="flex items-center py-8 px-4 lg:px-8 xl:px-16">
                        <img
                            class="w-8 h-8 shrink-0 transition-all duration-300 lg:w-12 lg:h-12"
                            src="https://laravel.com/img/logomark.min.svg"
                            alt="Laravel"
                            width="50"
                            height="52"
                        >
                        <img
                            src="https://laravel.com/img/logotype.min.svg"
                            alt="Laravel"
                            class="hidden ml-4 lg:block"
                            width="114"
                            height="29"
                        >
                    </a>
                    <div class="px-4 pb-10 lg:px-8 xl:px-16">
                        <nav id="indexed-nav" class="hidden lg:block lg:mt-4">
                            <div class="docs_sidebar">
                                <ul>
<li>
<h2>Prologue</h2>
<ul>
<li>
<a href="releases.html">Release Notes</a>
</li>
<li>
<a href="upgrade.html">Upgrade Guide</a>
</li>
<li>
<a href="contributions.html">Contribution Guide</a>
</li>
</ul>
</li>
<li>
<h2>Getting Started</h2>
<ul>
<li>
<a href="installation.html">Installation</a>
</li>
<li>
<a href="configuration.html">Configuration</a>
</li>
<li>
<a href="structure.html">Directory Structure</a>
</li>
<li>
<a href="frontend.html">Frontend</a>
</li>
<li>
<a href="starter-kits.html">Starter Kits</a>
</li>
<li>
<a href="deployment.html">Deployment</a>
</li>
</ul>
</li>
<li>
<h2>Architecture Concepts</h2>
<ul>
<li>
<a href="lifecycle.html">Request Lifecycle</a>
</li>
<li>
<a href="container.html">Service Container</a>
</li>
<li>
<a href="providers.html">Service Providers</a>
</li>
<li>
<a href="facades.html">Facades</a>
</li>
</ul>
</li>
<li>
<h2>The Basics</h2>
<ul>
<li>
<a href="routing.html">Routing</a>
</li>
<li>
<a href="middleware.html">Middleware</a>
</li>
<li>
<a href="csrf.html">CSRF Protection</a>
</li>
<li>
<a href="controllers.html">Controllers</a>
</li>
<li>
<a href="requests.html">Requests</a>
</li>
<li>
<a href="responses.html">Responses</a>
</li>
<li>
<a href="views.html">Views</a>
</li>
<li>
<a href="blade.html">Blade Templates</a>
</li>
<li>
<a href="vite.html">Asset Bundling</a>
</li>
<li>
<a href="urls.html">URL Generation</a>
</li>
<li>
<a href="session.html">Session</a>
</li>
<li>
<a href="validation.html">Validation</a>
</li>
<li>
<a href="errors.html">Error Handling</a>
</li>
<li>
<a href="logging.html">Logging</a>
</li>
</ul>
</li>
<li class="sub--on">
<h2>Digging Deeper</h2>
<ul>
<li>
<a href="artisan.html">Artisan Console</a>
</li>
<li>
<a href="broadcasting.html">Broadcasting</a>
</li>
<li>
<a href="cache.html">Cache</a>
</li>
<li>
<a href="collections.html">Collections</a>
</li>
<li>
<a href="concurrency.html">Concurrency</a>
</li>
<li>
<a href="context.html">Context</a>
</li>
<li>
<a href="contracts.html">Contracts</a>
</li>
<li>
<a href="events.html">Events</a>
</li>
<li>
<a href="filesystem.html">File Storage</a>
</li>
<li>
<a href="helpers.html">Helpers</a>
</li>
<li>
<a href="http-client.html">HTTP Client</a>
</li>
<li>
<a href="localization.html">Localization</a>
</li>
<li>
<a href="mail.html">Mail</a>
</li>
<li>
<a href="notifications.html">Notifications</a>
</li>
<li>
<a href="packages.html">Package Development</a>
</li>
<li>
<a href="processes.html">Processes</a>
</li>
<li class="active">
<a href="queues.html">Queues</a>
</li>
<li>
<a href="rate-limiting.html">Rate Limiting</a>
</li>
<li>
<a href="strings.html">Strings</a>
</li>
<li>
<a href="scheduling.html">Task Scheduling</a>
</li>
</ul>
</li>
<li>
<h2>Security</h2>
<ul>
<li>
<a href="authentication.html">Authentication</a>
</li>
<li>
<a href="authorization.html">Authorization</a>
</li>
<li>
<a href="verification.html">Email Verification</a>
</li>
<li>
<a href="encryption.html">Encryption</a>
</li>
<li>
<a href="hashing.html">Hashing</a>
</li>
<li>
<a href="passwords.html">Password Reset</a>
</li>
</ul>
</li>
<li>
<h2>Database</h2>
<ul>
<li>
<a href="database.html">Getting Started</a>
</li>
<li>
<a href="queries.html">Query Builder</a>
</li>
<li>
<a href="pagination.html">Pagination</a>
</li>
<li>
<a href="migrations.html">Migrations</a>
</li>
<li>
<a href="seeding.html">Seeding</a>
</li>
<li>
<a href="redis.html">Redis</a>
</li>
</ul>
</li>
<li>
<h2>Eloquent ORM</h2>
<ul>
<li>
<a href="eloquent.html">Getting Started</a>
</li>
<li>
<a href="eloquent-relationships.html">Relationships</a>
</li>
<li>
<a href="eloquent-collections.html">Collections</a>
</li>
<li>
<a href="eloquent-mutators.html">Mutators / Casts</a>
</li>
<li>
<a href="eloquent-resources.html">API Resources</a>
</li>
<li>
<a href="eloquent-serialization.html">Serialization</a>
</li>
<li>
<a href="eloquent-factories.html">Factories</a>
</li>
</ul>
</li>
<li>
<h2>Testing</h2>
<ul>
<li>
<a href="testing.html">Getting Started</a>
</li>
<li>
<a href="http-tests.html">HTTP Tests</a>
</li>
<li>
<a href="console-tests.html">Console Tests</a>
</li>
<li>
<a href="dusk.html">Browser Tests</a>
</li>
<li>
<a href="database-testing.html">Database</a>
</li>
<li>
<a href="mocking.html">Mocking</a>
</li>
</ul>
</li>
<li>
<h2>Packages</h2>
<ul>
<li>
<a href="starter-kits.html#laravel-breeze">Breeze</a>
</li>
<li>
<a href="billing.html">Cashier (Stripe)</a>
</li>
<li>
<a href="cashier-paddle.html">Cashier (Paddle)</a>
</li>
<li>
<a href="dusk.html">Dusk</a>
</li>
<li>
<a href="envoy.html">Envoy</a>
</li>
<li>
<a href="fortify.html">Fortify</a>
</li>
<li>
<a href="folio.html">Folio</a>
</li>
<li>
<a href="homestead.html">Homestead</a>
</li>
<li>
<a href="horizon.html">Horizon</a>
</li>
<li>
<a href="https://jetstream.laravel.com/">Jetstream</a>
</li>
<li>
<a href="mix.html">Mix</a>
</li>
<li>
<a href="octane.html">Octane</a>
</li>
<li>
<a href="passport.html">Passport</a>
</li>
<li>
<a href="pennant.html">Pennant</a>
</li>
<li>
<a href="pint.html">Pint</a>
</li>
<li>
<a href="precognition.html">Precognition</a>
</li>
<li>
<a href="prompts.html">Prompts</a>
</li>
<li>
<a href="pulse.html">Pulse</a>
</li>
<li>
<a href="reverb.html">Reverb</a>
</li>
<li>
<a href="sail.html">Sail</a>
</li>
<li>
<a href="sanctum.html">Sanctum</a>
</li>
<li>
<a href="scout.html">Scout</a>
</li>
<li>
<a href="socialite.html">Socialite</a>
</li>
<li>
<a href="telescope.html">Telescope</a>
</li>
<li>
<a href="valet.html">Valet</a>
</li>
</ul>
</li>
<li>
<a href="https://laravel.com/api/11.x">API Documentation</a>
</li>
</ul>

                            </div>
                        </nav>

                        
                        <template id="promote-forge">
                            <div class="mt-4 px-3 py-2 border-dashed border-gray-200 border rounded-lg text-xs leading-loose text-gray-700 lg:block dark:border-gray-400 dark:text-gray-200">
                                <span class="font-medium">Laravel Forge:</span> create and manage PHP 8 servers. Deploy your Laravel applications in seconds. <a class="underline text-red-600" href="https://forge.laravel.com/">Sign up now!</a>.
                            </div>
                        </template>

                        <template id="promote-vapor">
                            <div class="mt-4 px-3 py-2 border-dashed border-gray-200 border rounded-lg text-xs leading-loose text-gray-700 lg:block dark:border-gray-400 dark:text-gray-200">
                                <span class="font-medium">Laravel Vapor:</span> experience extreme scale on a dedicated serverless platform for Laravel. <a class="underline text-red-600" href="https://vapor.laravel.com/">Sign up now!</a>.
                            </div>
                        </template>

                        <template id="promote-nova">
                            <div class="mt-4 px-3 py-2 border-dashed border-gray-200 border rounded-lg text-xs leading-loose text-gray-700 lg:block dark:border-gray-400 dark:text-gray-200">
                                <span class="font-medium">Laravel Nova:</span> The next generation of Nova is <a class="underline text-red-600" href="https://nova.laravel.com/">now available</a>.
                            </div>
                        </template>

                        <template id="promote-pulse">
                            <div class="mt-4 px-3 py-2 border-dashed border-gray-200 border rounded-lg text-xs leading-loose text-gray-700 lg:block dark:border-gray-400 dark:text-gray-200">
                                <span class="font-medium">Laravel Pulse:</span> How's your health? Check your application's vital signs using <a href="https://pulse.laravel.com/" class="underline text-red-600">Laravel Pulse</a>.
                            </div>
                        </template>

                        <template id="promote-reverb">
                            <div class="mt-4 px-3 py-2 border-dashed border-gray-200 border rounded-lg text-xs leading-loose text-gray-700 lg:block dark:border-gray-400 dark:text-gray-200">
                                <span class="font-medium">Laravel Reverb:</span> You can easily build dynamic, real-time Laravel applications using WebSockets. <a href="https://reverb.laravel.com/" class="underline text-red-600">Laravel Reverb</a> is now available!
                            </div>
                        </template>
                        <script>
                            const activePromotionTemplate = document.getElementById(
                                'promote-'+JSON.parse('[\u0022forge\u0022,\u0022vapor\u0022,\u0022nova\u0022,\u0022pulse\u0022,\u0022reverb\u0022]')[Math.floor(Math.random() * 5)]
                            )

                            activePromotionTemplate.replaceWith(activePromotionTemplate.content)
                        </script>
                    </div>
                </div>
            </aside>

            <header
                class="lg:hidden"
                @keydown.window.escape="navIsOpen = false"
                @click.away="navIsOpen = false"
            >
                <div class="relative mx-auto w-full py-10 bg-white transition duration-200 dark:bg-dark-700">
                    <div class="mx-auto px-8 sm:px-16 flex items-center justify-between">
                        <a href="https://laravel.com/" class="flex items-center">
                            <img class="" src="https://laravel.com/img/logomark.min.svg" alt="Laravel" width="50" height="52">
                            <img class="hidden ml-5 sm:block" src="https://laravel.com/img/logotype.min.svg" alt="Laravel" width="114" height="29">
                        </a>
                        <div class="flex-1 flex items-center justify-end">
                            <button id="header__sun" onclick="toSystemMode()" title="Switch to system theme" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <circle cx="12" cy="12" r="4"></circle>
                                    <path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
                                 </svg>
                            </button>
                            <button id="header__moon" onclick="toLightMode()" title="Switch to light mode" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z" />
                                </svg>
                            </button>
                            <button id="header__indeterminate" onclick="toDarkMode()" title="Switch to dark mode" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M12 2A10 10 0 0 0 2 12A10 10 0 0 0 12 22A10 10 0 0 0 22 12A10 10 0 0 0 12 2M12 4A8 8 0 0 1 20 12A8 8 0 0 1 12 20V4Z" />
                                </svg>
                            </button>
                            <button class="ml-2 relative w-10 h-10 p-2 text-red-600 lg:hidden focus:outline-none focus:shadow-outline" aria-label="Menu" @click.prevent="navIsOpen = !navIsOpen">
                                <svg x-show="! navIsOpen" x-transition.opacity class="absolute inset-0 mt-2 ml-2 w-6 h-6" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                                <svg x-show="navIsOpen" x-transition.opacity x-cloak class="absolute inset-0 mt-2 ml-2 w-6 h-6" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                            </button>
                        </div>
                    </div>
                    <span :class="{ 'shadow-sm': navIsOpen }" class="absolute inset-0 z-20 pointer-events-none"></span>
                </div>
                <div
                    x-show="navIsOpen"
                    x-transition:enter="duration-150"
                    x-transition:leave="duration-100 ease-in"
                    x-cloak
                >
                    <nav
                        x-show="navIsOpen"
                        x-cloak
                        class="absolute w-full transform origin-top shadow-sm z-10"
                        x-transition:enter="duration-150 ease-out"
                        x-transition:enter-start="opacity-0 -translate-y-8 scale-75"
                        x-transition:enter-end="opacity-100 scale-100"
                        x-transition:leave="duration-100 ease-in"
                        x-transition:leave-start="opacity-100 scale-100"
                        x-transition:leave-end="opacity-0 -translate-y-8 scale-75"
                    >
                        <div class="relative p-8 bg-white docs_sidebar dark:bg-dark-600">
                            <ul>
<li>
<h2>Prologue</h2>
<ul>
<li>
<a href="releases.html">Release Notes</a>
</li>
<li>
<a href="upgrade.html">Upgrade Guide</a>
</li>
<li>
<a href="contributions.html">Contribution Guide</a>
</li>
</ul>
</li>
<li>
<h2>Getting Started</h2>
<ul>
<li>
<a href="installation.html">Installation</a>
</li>
<li>
<a href="configuration.html">Configuration</a>
</li>
<li>
<a href="structure.html">Directory Structure</a>
</li>
<li>
<a href="frontend.html">Frontend</a>
</li>
<li>
<a href="starter-kits.html">Starter Kits</a>
</li>
<li>
<a href="deployment.html">Deployment</a>
</li>
</ul>
</li>
<li>
<h2>Architecture Concepts</h2>
<ul>
<li>
<a href="lifecycle.html">Request Lifecycle</a>
</li>
<li>
<a href="container.html">Service Container</a>
</li>
<li>
<a href="providers.html">Service Providers</a>
</li>
<li>
<a href="facades.html">Facades</a>
</li>
</ul>
</li>
<li>
<h2>The Basics</h2>
<ul>
<li>
<a href="routing.html">Routing</a>
</li>
<li>
<a href="middleware.html">Middleware</a>
</li>
<li>
<a href="csrf.html">CSRF Protection</a>
</li>
<li>
<a href="controllers.html">Controllers</a>
</li>
<li>
<a href="requests.html">Requests</a>
</li>
<li>
<a href="responses.html">Responses</a>
</li>
<li>
<a href="views.html">Views</a>
</li>
<li>
<a href="blade.html">Blade Templates</a>
</li>
<li>
<a href="vite.html">Asset Bundling</a>
</li>
<li>
<a href="urls.html">URL Generation</a>
</li>
<li>
<a href="session.html">Session</a>
</li>
<li>
<a href="validation.html">Validation</a>
</li>
<li>
<a href="errors.html">Error Handling</a>
</li>
<li>
<a href="logging.html">Logging</a>
</li>
</ul>
</li>
<li class="sub--on">
<h2>Digging Deeper</h2>
<ul>
<li>
<a href="artisan.html">Artisan Console</a>
</li>
<li>
<a href="broadcasting.html">Broadcasting</a>
</li>
<li>
<a href="cache.html">Cache</a>
</li>
<li>
<a href="collections.html">Collections</a>
</li>
<li>
<a href="concurrency.html">Concurrency</a>
</li>
<li>
<a href="context.html">Context</a>
</li>
<li>
<a href="contracts.html">Contracts</a>
</li>
<li>
<a href="events.html">Events</a>
</li>
<li>
<a href="filesystem.html">File Storage</a>
</li>
<li>
<a href="helpers.html">Helpers</a>
</li>
<li>
<a href="http-client.html">HTTP Client</a>
</li>
<li>
<a href="localization.html">Localization</a>
</li>
<li>
<a href="mail.html">Mail</a>
</li>
<li>
<a href="notifications.html">Notifications</a>
</li>
<li>
<a href="packages.html">Package Development</a>
</li>
<li>
<a href="processes.html">Processes</a>
</li>
<li class="active">
<a href="queues.html">Queues</a>
</li>
<li>
<a href="rate-limiting.html">Rate Limiting</a>
</li>
<li>
<a href="strings.html">Strings</a>
</li>
<li>
<a href="scheduling.html">Task Scheduling</a>
</li>
</ul>
</li>
<li>
<h2>Security</h2>
<ul>
<li>
<a href="authentication.html">Authentication</a>
</li>
<li>
<a href="authorization.html">Authorization</a>
</li>
<li>
<a href="verification.html">Email Verification</a>
</li>
<li>
<a href="encryption.html">Encryption</a>
</li>
<li>
<a href="hashing.html">Hashing</a>
</li>
<li>
<a href="passwords.html">Password Reset</a>
</li>
</ul>
</li>
<li>
<h2>Database</h2>
<ul>
<li>
<a href="database.html">Getting Started</a>
</li>
<li>
<a href="queries.html">Query Builder</a>
</li>
<li>
<a href="pagination.html">Pagination</a>
</li>
<li>
<a href="migrations.html">Migrations</a>
</li>
<li>
<a href="seeding.html">Seeding</a>
</li>
<li>
<a href="redis.html">Redis</a>
</li>
</ul>
</li>
<li>
<h2>Eloquent ORM</h2>
<ul>
<li>
<a href="eloquent.html">Getting Started</a>
</li>
<li>
<a href="eloquent-relationships.html">Relationships</a>
</li>
<li>
<a href="eloquent-collections.html">Collections</a>
</li>
<li>
<a href="eloquent-mutators.html">Mutators / Casts</a>
</li>
<li>
<a href="eloquent-resources.html">API Resources</a>
</li>
<li>
<a href="eloquent-serialization.html">Serialization</a>
</li>
<li>
<a href="eloquent-factories.html">Factories</a>
</li>
</ul>
</li>
<li>
<h2>Testing</h2>
<ul>
<li>
<a href="testing.html">Getting Started</a>
</li>
<li>
<a href="http-tests.html">HTTP Tests</a>
</li>
<li>
<a href="console-tests.html">Console Tests</a>
</li>
<li>
<a href="dusk.html">Browser Tests</a>
</li>
<li>
<a href="database-testing.html">Database</a>
</li>
<li>
<a href="mocking.html">Mocking</a>
</li>
</ul>
</li>
<li>
<h2>Packages</h2>
<ul>
<li>
<a href="starter-kits.html#laravel-breeze">Breeze</a>
</li>
<li>
<a href="billing.html">Cashier (Stripe)</a>
</li>
<li>
<a href="cashier-paddle.html">Cashier (Paddle)</a>
</li>
<li>
<a href="dusk.html">Dusk</a>
</li>
<li>
<a href="envoy.html">Envoy</a>
</li>
<li>
<a href="fortify.html">Fortify</a>
</li>
<li>
<a href="folio.html">Folio</a>
</li>
<li>
<a href="homestead.html">Homestead</a>
</li>
<li>
<a href="horizon.html">Horizon</a>
</li>
<li>
<a href="https://jetstream.laravel.com/">Jetstream</a>
</li>
<li>
<a href="mix.html">Mix</a>
</li>
<li>
<a href="octane.html">Octane</a>
</li>
<li>
<a href="passport.html">Passport</a>
</li>
<li>
<a href="pennant.html">Pennant</a>
</li>
<li>
<a href="pint.html">Pint</a>
</li>
<li>
<a href="precognition.html">Precognition</a>
</li>
<li>
<a href="prompts.html">Prompts</a>
</li>
<li>
<a href="pulse.html">Pulse</a>
</li>
<li>
<a href="reverb.html">Reverb</a>
</li>
<li>
<a href="sail.html">Sail</a>
</li>
<li>
<a href="sanctum.html">Sanctum</a>
</li>
<li>
<a href="scout.html">Scout</a>
</li>
<li>
<a href="socialite.html">Socialite</a>
</li>
<li>
<a href="telescope.html">Telescope</a>
</li>
<li>
<a href="valet.html">Valet</a>
</li>
</ul>
</li>
<li>
<a href="https://laravel.com/api/11.x">API Documentation</a>
</li>
</ul>

                        </div>
                    </nav>
                </div>
            </header>

            <section class="flex-1 dark:bg-dark-700">
                <div class="max-w-screen-lg px-8 sm:px-16 lg:px-24">
                    <div class="flex flex-col items-end border-b border-gray-200 py-1 transition-colors dark:border-gray-700 lg:mt-8 lg:flex-row-reverse">
                        <div class="hidden lg:flex items-center justify-center ml-8">
                            <button id="header__sun" onclick="toSystemMode()" title="Switch to system theme" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <circle cx="12" cy="12" r="4"></circle>
                                    <path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
                                 </svg>
                            </button>
                            <button id="header__moon" onclick="toLightMode()" title="Switch to light mode" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z" />
                                </svg>
                            </button>
                            <button id="header__indeterminate" onclick="toDarkMode()" title="Switch to dark mode" class="relative w-10 h-10 focus:outline-none focus:shadow-outline text-gray-500">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M12 2A10 10 0 0 0 2 12A10 10 0 0 0 12 22A10 10 0 0 0 22 12A10 10 0 0 0 12 2M12 4A8 8 0 0 1 20 12A8 8 0 0 1 12 20V4Z" />
                                </svg>
                            </button>
                        </div>
                        <div class="w-full lg:w-40 lg:pl-12">
                            <div>
                                <label class="text-gray-600 text-xs tracking-widest uppercase dark:text-gray-500" for="version-switcher">Version</label>
                                <div x-data class="relative w-full bg-white transition-all duration-500 focus-within:border-gray-600 dark:bg-gray-800">
                                    <select
                                        id="version-switcher"
                                        aria-label="Laravel version"
                                        class="appearance-none flex-1 w-full px-0 py-1 placeholder-gray-900 tracking-wide bg-white border-transparent focus:outline-none dark:bg-dark-700 dark:text-gray-400 dark:placeholder-gray-500"
                                        @change="window.location = $event.target.value"
                                    >
                                                                                    <option  value="https://laravel.com/docs/master/queues">Master</option>
                                                                                    <option selected value="queues.html">11.x</option>
                                                                                    <option  value="https://laravel.com/docs/10.x/queues">10.x</option>
                                                                                    <option  value="https://laravel.com/docs/9.x/queues">9.x</option>
                                                                                    <option  value="https://laravel.com/docs/8.x/queues">8.x</option>
                                                                                    <option  value="https://laravel.com/docs/7.x/queues">7.x</option>
                                                                                    <option  value="https://laravel.com/docs/6.x/queues">6.x</option>
                                                                                    <option  value="https://laravel.com/docs/5.8/queues">5.8</option>
                                                                                    <option  value="https://laravel.com/docs/5.7/queues">5.7</option>
                                                                                    <option  value="https://laravel.com/docs/5.6/queues">5.6</option>
                                                                                    <option  value="https://laravel.com/docs/5.5/queues">5.5</option>
                                                                                    <option  value="https://laravel.com/docs/5.4/queues">5.4</option>
                                                                                    <option  value="https://laravel.com/docs/5.3/queues">5.3</option>
                                                                                    <option  value="https://laravel.com/docs/5.2/queues">5.2</option>
                                                                                    <option  value="https://laravel.com/docs/5.1/queues">5.1</option>
                                                                                    <option  value="https://laravel.com/docs/5.0/queues">5.0</option>
                                                                                    <option  value="https://laravel.com/docs/4.2/queues">4.2</option>
                                                                            </select>
                                    <img class="absolute inset-y-0 right-0 mt-2.5 w-2.5 h-2.5 text-gray-900 pointer-events-none dark:hidden" src="https://laravel.com/img/icons/drop_arrow.min.svg" alt="" width="10" height="10">
                                    <img class="absolute inset-y-0 right-0 mt-2.5 w-2.5 h-2.5 text-gray-900 pointer-events-none hidden dark:block" src="https://laravel.com/img/icons/drop_arrow.dark.min.svg" alt="" width="10" height="10">
                                </div>
                            </div>
                        </div>
                        <div class="relative mt-8 flex items-center justify-end w-full h-10 lg:mt-0">
                            <div class="flex-1 flex items-center">
                                <button id="docsearch" class="text-gray-800 transition-colors dark:text-gray-400 w-full"></button>
                            </div>
                        </div>
                    </div>

                    <section class="mt-8 md:mt-16">
                        <section class="docs_main max-w-prose">
                            
                            
                            <div id="main-content">
    <h1>Queues</h1>
<ul>
<li>
<a href="#introduction">Introduction</a>
<ul>
<li>
<a href="#connections-vs-queues">Connections vs. Queues</a>
</li>
<li>
<a href="#driver-prerequisites">Driver Notes and Prerequisites</a>
</li>
</ul>
</li>
<li>
<a href="#creating-jobs">Creating Jobs</a>
<ul>
<li>
<a href="#generating-job-classes">Generating Job Classes</a>
</li>
<li>
<a href="#class-structure">Class Structure</a>
</li>
<li>
<a href="#unique-jobs">Unique Jobs</a>
</li>
<li>
<a href="#encrypted-jobs">Encrypted Jobs</a>
</li>
</ul>
</li>
<li>
<a href="#job-middleware">Job Middleware</a>
<ul>
<li>
<a href="#rate-limiting">Rate Limiting</a>
</li>
<li>
<a href="#preventing-job-overlaps">Preventing Job Overlaps</a>
</li>
<li>
<a href="#throttling-exceptions">Throttling Exceptions</a>
</li>
<li>
<a href="#skipping-jobs">Skipping Jobs</a>
</li>
</ul>
</li>
<li>
<a href="#dispatching-jobs">Dispatching Jobs</a>
<ul>
<li>
<a href="#delayed-dispatching">Delayed Dispatching</a>
</li>
<li>
<a href="#synchronous-dispatching">Synchronous Dispatching</a>
</li>
<li>
<a href="#jobs-and-database-transactions">Jobs &amp; Database Transactions</a>
</li>
<li>
<a href="#job-chaining">Job Chaining</a>
</li>
<li>
<a href="#customizing-the-queue-and-connection">Customizing The Queue and Connection</a>
</li>
<li>
<a href="#max-job-attempts-and-timeout">Specifying Max Job Attempts / Timeout Values</a>
</li>
<li>
<a href="#error-handling">Error Handling</a>
</li>
</ul>
</li>
<li>
<a href="#job-batching">Job Batching</a>
<ul>
<li>
<a href="#defining-batchable-jobs">Defining Batchable Jobs</a>
</li>
<li>
<a href="#dispatching-batches">Dispatching Batches</a>
</li>
<li>
<a href="#chains-and-batches">Chains and Batches</a>
</li>
<li>
<a href="#adding-jobs-to-batches">Adding Jobs to Batches</a>
</li>
<li>
<a href="#inspecting-batches">Inspecting Batches</a>
</li>
<li>
<a href="#cancelling-batches">Cancelling Batches</a>
</li>
<li>
<a href="#batch-failures">Batch Failures</a>
</li>
<li>
<a href="#pruning-batches">Pruning Batches</a>
</li>
<li>
<a href="#storing-batches-in-dynamodb">Storing Batches in DynamoDB</a>
</li>
</ul>
</li>
<li>
<a href="#queueing-closures">Queueing Closures</a>
</li>
<li>
<a href="#running-the-queue-worker">Running the Queue Worker</a>
<ul>
<li>
<a href="#the-queue-work-command">The <code>queue:work</code> Command</a>
</li>
<li>
<a href="#queue-priorities">Queue Priorities</a>
</li>
<li>
<a href="#queue-workers-and-deployment">Queue Workers and Deployment</a>
</li>
<li>
<a href="#job-expirations-and-timeouts">Job Expirations and Timeouts</a>
</li>
</ul>
</li>
<li>
<a href="#supervisor-configuration">Supervisor Configuration</a>
</li>
<li>
<a href="#dealing-with-failed-jobs">Dealing With Failed Jobs</a>
<ul>
<li>
<a href="#cleaning-up-after-failed-jobs">Cleaning Up After Failed Jobs</a>
</li>
<li>
<a href="#retrying-failed-jobs">Retrying Failed Jobs</a>
</li>
<li>
<a href="#ignoring-missing-models">Ignoring Missing Models</a>
</li>
<li>
<a href="#pruning-failed-jobs">Pruning Failed Jobs</a>
</li>
<li>
<a href="#storing-failed-jobs-in-dynamodb">Storing Failed Jobs in DynamoDB</a>
</li>
<li>
<a href="#disabling-failed-job-storage">Disabling Failed Job Storage</a>
</li>
<li>
<a href="#failed-job-events">Failed Job Events</a>
</li>
</ul>
</li>
<li>
<a href="#clearing-jobs-from-queues">Clearing Jobs From Queues</a>
</li>
<li>
<a href="#monitoring-your-queues">Monitoring Your Queues</a>
</li>
<li>
<a href="#testing">Testing</a>
<ul>
<li>
<a href="#faking-a-subset-of-jobs">Faking a Subset of Jobs</a>
</li>
<li>
<a href="#testing-job-chains">Testing Job Chains</a>
</li>
<li>
<a href="#testing-job-batches">Testing Job Batches</a>
</li>
<li>
<a href="#testing-job-queue-interactions">Testing Job / Queue Interactions</a>
</li>
</ul>
</li>
<li>
<a href="#job-events">Job Events</a>
</li>
</ul>
<h2 id="introduction"><a href="#introduction">Introduction</a></h2>
<p>While building your web application, you may have some tasks, such as parsing and storing an uploaded CSV file, that take too long to perform during a typical web request. Thankfully, Laravel allows you to easily create queued jobs that may be processed in the background. By moving time intensive tasks to a queue, your application can respond to web requests with blazing speed and provide a better user experience to your customers.</p>
<p>Laravel queues provide a unified queueing API across a variety of different queue backends, such as <a href="https://aws.amazon.com/sqs/">Amazon SQS</a>, <a href="https://redis.io/">Redis</a>, or even a relational database.</p>
<p>Laravel's queue configuration options are stored in your application's <code>config/queue.php</code> configuration file. In this file, you will find connection configurations for each of the queue drivers that are included with the framework, including the database, <a href="https://aws.amazon.com/sqs/">Amazon SQS</a>, <a href="https://redis.io/">Redis</a>, and <a href="https://beanstalkd.github.io/">Beanstalkd</a> drivers, as well as a synchronous driver that will execute jobs immediately (for use during local development). A <code>null</code> queue driver is also included which discards queued jobs.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Laravel now offers Horizon, a beautiful dashboard and configuration system for your Redis powered queues. Check out the full <a href="horizon.html">Horizon documentation</a> for more information.</p>
</div>
<h3 id="connections-vs-queues"><a href="#connections-vs-queues">Connections vs. Queues</a></h3>
<p>Before getting started with Laravel queues, it is important to understand the distinction between &quot;connections&quot; and &quot;queues&quot;. In your <code>config/queue.php</code> configuration file, there is a <code>connections</code> configuration array. This option defines the connections to backend queue services such as Amazon SQS, Beanstalk, or Redis. However, any given queue connection may have multiple &quot;queues&quot; which may be thought of as different stacks or piles of queued jobs.</p>
<p>Note that each connection configuration example in the <code>queue</code> configuration file contains a <code>queue</code> attribute. This is the default queue that jobs will be dispatched to when they are sent to a given connection. In other words, if you dispatch a job without explicitly defining which queue it should be dispatched to, the job will be placed on the queue that is defined in the <code>queue</code> attribute of the connection configuration:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> This job is sent to the default connection&#39;s default queue...</span></div><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> This job is sent to the default connection&#39;s &quot;emails&quot; queue...</span></div><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">emails</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<p>Some applications may not need to ever push jobs onto multiple queues, instead preferring to have one simple queue. However, pushing jobs to multiple queues can be especially useful for applications that wish to prioritize or segment how jobs are processed, since the Laravel queue worker allows you to specify which queues it should process by priority. For example, if you push jobs to a <code>high</code> queue, you may run a worker that gives them higher processing priority:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--queue=high,default</span></div></code></pre>
</div>
<h3 id="driver-prerequisites"><a href="#driver-prerequisites">Driver Notes and Prerequisites</a></h3>
<h4 id="database"><a href="#database">Database</a></h4>
<p>In order to use the <code>database</code> queue driver, you will need a database table to hold the jobs. Typically, this is included in Laravel's default <code>0001_01_01_000002_create_jobs_table.php</code> <a href="migrations.html">database migration</a>; however, if your application does not contain this migration, you may use the <code>make:queue-table</code> Artisan command to create it:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">make:queue-table</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">migrate</span></div></code></pre>
</div>
<h4 id="redis"><a href="#redis">Redis</a></h4>
<p>In order to use the <code>redis</code> queue driver, you should configure a Redis database connection in your <code>config/database.php</code> configuration file.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The <code>serializer</code> and <code>compression</code> Redis options are not supported by the <code>redis</code> queue driver.</p>
</div>
<p><strong>Redis Cluster</strong></p>
<p>If your Redis queue connection uses a Redis Cluster, your queue names must contain a <a href="https://redis.io/docs/reference/cluster-spec/#hash-tags">key hash tag</a>. This is required in order to ensure all of the Redis keys for a given queue are placed into the same hash slot:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">connection</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE_CONNECTION</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">default</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">{default}</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">retry_after</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE_RETRY_AFTER</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #F78C6C;">90</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">block_for</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">null</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">after_commit</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">false</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
<p><strong>Blocking</strong></p>
<p>When using the Redis queue, you may use the <code>block_for</code> configuration option to specify how long the driver should wait for a job to become available before iterating through the worker loop and re-polling the Redis database.</p>
<p>Adjusting this value based on your queue load can be more efficient than continually polling the Redis database for new jobs. For instance, you may set the value to <code>5</code> to indicate that the driver should block for five seconds while waiting for a job to become available:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">connection</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE_CONNECTION</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">default</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">default</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">retry_after</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">REDIS_QUEUE_RETRY_AFTER</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #F78C6C;">90</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">block_for</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">after_commit</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">false</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Setting <code>block_for</code> to <code>0</code> will cause queue workers to block indefinitely until a job is available. This will also prevent signals such as <code>SIGTERM</code> from being handled until the next job has been processed.</p>
</div>
<h4 id="other-driver-prerequisites"><a href="#other-driver-prerequisites">Other Driver Prerequisites</a></h4>
<p>The following dependencies are needed for the listed queue drivers. These dependencies may be installed via the Composer package manager:</p>
<div class="content-list" markdown="1">
<ul>
<li>Amazon SQS: <code>aws/aws-sdk-php ~3.0</code>
</li>
<li>Beanstalkd: <code>pda/pheanstalk ~5.0</code>
</li>
<li>Redis: <code>predis/predis ~2.0</code> or phpredis PHP extension</li>
</ul>
</div>
<h2 id="creating-jobs"><a href="#creating-jobs">Creating Jobs</a></h2>
<h3 id="generating-job-classes"><a href="#generating-job-classes">Generating Job Classes</a></h3>
<p>By default, all of the queueable jobs for your application are stored in the <code>app/Jobs</code> directory. If the <code>app/Jobs</code> directory doesn't exist, it will be created when you run the <code>make:job</code> Artisan command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">make:job</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">ProcessPodcast</span></div></code></pre>
</div>
<p>The generated class will implement the <code>Illuminate\Contracts\Queue\ShouldQueue</code> interface, indicating to Laravel that the job should be pushed onto the queue to run asynchronously.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Job stubs may be customized using <a href="artisan.html#stub-customization">stub publishing</a>.</p>
</div>
<h3 id="class-structure"><a href="#class-structure">Class Structure</a></h3>
<p>Job classes are very simple, normally containing only a <code>handle</code> method that is invoked when the job is processed by the queue. To get started, let's take a look at an example job class. In this example, we'll pretend we manage a podcast publishing service and need to process the uploaded podcast files before they are published:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Services\</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Foundation\Queue\</span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Create a new job instance.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">(</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {}</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Execute the job.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$processor</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Process uploaded podcast...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In this example, note that we were able to pass an <a href="eloquent.html">Eloquent model</a> directly into the queued job's constructor. Because of the <code>Queueable</code> trait that the job is using, Eloquent models and their loaded relationships will be gracefully serialized and unserialized when the job is processing.</p>
<p>If your queued job accepts an Eloquent model in its constructor, only the identifier for the model will be serialized onto the queue. When the job is actually handled, the queue system will automatically re-retrieve the full model instance and its loaded relationships from the database. This approach to model serialization allows for much smaller job payloads to be sent to your queue driver.</p>
<h4 id="handle-method-dependency-injection"><a href="#handle-method-dependency-injection"><code>handle</code> Method Dependency Injection</a></h4>
<p>The <code>handle</code> method is invoked when the job is processed by the queue. Note that we are able to type-hint dependencies on the <code>handle</code> method of the job. The Laravel <a href="container.html">service container</a> automatically injects these dependencies.</p>
<p>If you would like to take total control over how the container injects dependencies into the <code>handle</code> method, you may use the container's <code>bindMethod</code> method. The <code>bindMethod</code> method accepts a callback which receives the job and the container. Within the callback, you are free to invoke the <code>handle</code> method however you wish. Typically, you should call this method from the <code>boot</code> method of your <code>App\Providers\AppServiceProvider</code> <a href="providers.html">service provider</a>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Services\</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Foundation\</span><span style="color: #FFCB8B;">Application</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;app-&gt;</span><span style="color: #82AAFF;">bindMethod</span><span style="color: #BFC7D5;">([</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">, </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">handle</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">], </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;">, </span><span style="color: #FFCB8B;">Application</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$app</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">handle</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$app</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">make</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">));</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Binary data, such as raw image contents, should be passed through the <code>base64_encode</code> function before being passed to a queued job. Otherwise, the job may not properly serialize to JSON when being placed on the queue.</p>
</div>
<h4 id="handling-relationships"><a href="#handling-relationships">Queued Relationships</a></h4>
<p>Because all loaded Eloquent model relationships also get serialized when a job is queued, the serialized job string can sometimes become quite large. Furthermore, when a job is deserialized and model relationships are re-retrieved from the database, they will be retrieved in their entirety. Any previous relationship constraints that were applied before the model was serialized during the job queueing process will not be applied when the job is deserialized. Therefore, if you wish to work with a subset of a given relationship, you should re-constrain that relationship within your queued job.</p>
<p>Or, to prevent relations from being serialized, you can call the <code>withoutRelations</code> method on the model when setting a property value. This method will return an instance of the model without its loaded relationships:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Create a new job instance.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">(</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">withoutRelations</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you are using PHP constructor property promotion and would like to indicate that an Eloquent model should not have its relations serialized, you may use the <code>WithoutRelations</code> attribute:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Attributes\</span><span style="color: #FFCB8B;">WithoutRelations</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Create a new job instance.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">(</span></div><div class='line'><span style="color: #BFC7D5;">    #[WithoutRelations]</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {}</span></div></code></pre>
<p>If a job receives a collection or array of Eloquent models instead of a single model, the models within that collection will not have their relationships restored when the job is deserialized and executed. This is to prevent excessive resource usage on jobs that deal with large numbers of models.</p>
<h3 id="unique-jobs"><a href="#unique-jobs">Unique Jobs</a></h3>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Unique jobs require a cache driver that supports <a href="cache.html#atomic-locks">locks</a>. Currently, the <code>memcached</code>, <code>redis</code>, <code>dynamodb</code>, <code>database</code>, <code>file</code>, and <code>array</code> cache drivers support atomic locks. In addition, unique job constraints do not apply to jobs within batches.</p>
</div>
<p>Sometimes, you may want to ensure that only one instance of a specific job is on the queue at any point in time. You may do so by implementing the <code>ShouldBeUnique</code> interface on your job class. This interface does not require you to define any additional methods on your class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldBeUnique</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">UpdateSearchIndex</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span><span style="color: #BFC7D5;">, </span><span style="color: #A9C77D;">ShouldBeUnique</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">...</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In the example above, the <code>UpdateSearchIndex</code> job is unique. So, the job will not be dispatched if another instance of the job is already on the queue and has not finished processing.</p>
<p>In certain cases, you may want to define a specific &quot;key&quot; that makes the job unique or you may want to specify a timeout beyond which the job no longer stays unique. To accomplish this, you may define <code>uniqueId</code> and <code>uniqueFor</code> properties or methods on your job class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Product</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldBeUnique</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">UpdateSearchIndex</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span><span style="color: #BFC7D5;">, </span><span style="color: #A9C77D;">ShouldBeUnique</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The product instance.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #697098;">\</span><span style="color: #697098;">App</span><span style="color: #697098;">\</span><span style="color: #FFCB8B;">Product</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$product</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The number of seconds after which the job&#39;s unique lock will be released.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$uniqueFor</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">3600</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Get the unique ID for the job.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">uniqueId</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">string</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;product-&gt;id</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In the example above, the <code>UpdateSearchIndex</code> job is unique by a product ID. So, any new dispatches of the job with the same product ID will be ignored until the existing job has completed processing. In addition, if the existing job is not processed within one hour, the unique lock will be released and another job with the same unique key can be dispatched to the queue.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
If your application dispatches jobs from multiple web servers or containers, you should ensure that all of your servers are communicating with the same central cache server so that Laravel can accurately determine if a job is unique.</p>
</div>
<h4 id="keeping-jobs-unique-until-processing-begins"><a href="#keeping-jobs-unique-until-processing-begins">Keeping Jobs Unique Until Processing Begins</a></h4>
<p>By default, unique jobs are &quot;unlocked&quot; after a job completes processing or fails all of its retry attempts. However, there may be situations where you would like your job to unlock immediately before it is processed. To accomplish this, your job should implement the <code>ShouldBeUniqueUntilProcessing</code> contract instead of the <code>ShouldBeUnique</code> contract:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Product</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldBeUniqueUntilProcessing</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">UpdateSearchIndex</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span><span style="color: #BFC7D5;">, </span><span style="color: #A9C77D;">ShouldBeUniqueUntilProcessing</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h4 id="unique-job-locks"><a href="#unique-job-locks">Unique Job Locks</a></h4>
<p>Behind the scenes, when a <code>ShouldBeUnique</code> job is dispatched, Laravel attempts to acquire a <a href="cache.html#atomic-locks">lock</a> with the <code>uniqueId</code> key. If the lock is not acquired, the job is not dispatched. This lock is released when the job completes processing or fails all of its retry attempts. By default, Laravel will use the default cache driver to obtain this lock. However, if you wish to use another driver for acquiring the lock, you may define a <code>uniqueVia</code> method that returns the cache driver that should be used:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Cache\</span><span style="color: #FFCB8B;">Repository</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Cache</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">UpdateSearchIndex</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span><span style="color: #BFC7D5;">, </span><span style="color: #A9C77D;">ShouldBeUnique</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Get the cache driver for the unique job lock.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">uniqueVia</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Repository</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Cache</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">driver</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
If you only need to limit the concurrent processing of a job, use the <a href="queues.html#preventing-job-overlaps"><code>WithoutOverlapping</code></a> job middleware instead.</p>
</div>
<h3 id="encrypted-jobs"><a href="#encrypted-jobs">Encrypted Jobs</a></h3>
<p>Laravel allows you to ensure the privacy and integrity of a job's data via <a href="encryption.html">encryption</a>. To get started, simply add the <code>ShouldBeEncrypted</code> interface to the job class. Once this interface has been added to the class, Laravel will automatically encrypt your job before pushing it onto a queue:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldBeEncrypted</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">UpdateSearchIndex</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span><span style="color: #BFC7D5;">, </span><span style="color: #A9C77D;">ShouldBeEncrypted</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h2 id="job-middleware"><a href="#job-middleware">Job Middleware</a></h2>
<p>Job middleware allow you to wrap custom logic around the execution of queued jobs, reducing boilerplate in the jobs themselves. For example, consider the following <code>handle</code> method which leverages Laravel's Redis rate limiting features to allow only one job to process every five seconds:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Redis</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Redis</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">throttle</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">block</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">0</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">allow</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">every</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #82AAFF;">info</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">Lock obtained...</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Handle job...</span></div><div class='line'><span style="color: #BFC7D5;">    }, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Could not obtain lock...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    });</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>While this code is valid, the implementation of the <code>handle</code> method becomes noisy since it is cluttered with Redis rate limiting logic. In addition, this rate limiting logic must be duplicated for any other jobs that we want to rate limit.</p>
<p>Instead of rate limiting in the handle method, we could define a job middleware that handles rate limiting. Laravel does not have a default location for job middleware, so you are welcome to place job middleware anywhere in your application. In this example, we will place the middleware in an <code>app/Jobs/Middleware</code> directory:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs\Middleware;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Closure</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Redis</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">RateLimited</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Process the queued job.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@param</span><span style="color: #697098;">  </span><span style="color: #697098;">\</span><span style="color: #FFCB8B;">Closure</span><span style="color: #697098;">(</span><span style="color: #C792EA;">object</span><span style="color: #697098;">): </span><span style="color: #C792EA;">void</span><span style="color: #697098;">  $</span><span style="color: #FFCB8B;">next</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">(</span><span style="color: #C792EA;">object</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;">, </span><span style="color: #FFCB8B;">Closure</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$next</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Redis</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">throttle</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">                </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">block</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">0</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">allow</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">every</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">                </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;">, </span><span style="color: #BEC5D4;">$next</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Lock obtained...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #BEC5D4;">$next</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">                }, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #BEC5D4;">$job</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Could not obtain lock...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">                });</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>As you can see, like <a href="middleware.html">route middleware</a>, job middleware receive the job being processed and a callback that should be invoked to continue processing the job.</p>
<p>After creating job middleware, they may be attached to a job by returning them from the job's <code>middleware</code> method. This method does not exist on jobs scaffolded by the <code>make:job</code> Artisan command, so you will need to manually add it to your job class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\Middleware\</span><span style="color: #FFCB8B;">RateLimited</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RateLimited</span><span style="color: #BFC7D5;">];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Job middleware can also be assigned to queueable event listeners, mailables, and notifications.</p>
</div>
<h3 id="rate-limiting"><a href="#rate-limiting">Rate Limiting</a></h3>
<p>Although we just demonstrated how to write your own rate limiting job middleware, Laravel actually includes a rate limiting middleware that you may utilize to rate limit jobs. Like <a href="routing.html#defining-rate-limiters">route rate limiters</a>, job rate limiters are defined using the <code>RateLimiter</code> facade's <code>for</code> method.</p>
<p>For example, you may wish to allow users to backup their data once per hour while imposing no such limit on premium customers. To accomplish this, you may define a <code>RateLimiter</code> in the <code>boot</code> method of your <code>AppServiceProvider</code>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Cache\RateLimiting\</span><span style="color: #FFCB8B;">Limit</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">RateLimiter</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Bootstrap any application services.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">boot</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">RateLimiter</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">for</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">backups</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #C792EA;">object</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;user-&gt;</span><span style="color: #82AAFF;">vipCustomer</span><span style="color: #BFC7D5;">()</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #89DDFF;">?</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Limit</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">none</span><span style="color: #BFC7D5;">()</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Limit</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">perHour</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">by</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;user-&gt;id</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    });</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In the example above, we defined an hourly rate limit; however, you may easily define a rate limit based on minutes using the <code>perMinute</code> method. In addition, you may pass any value you wish to the <code>by</code> method of the rate limit; however, this value is most often used to segment rate limits by customer:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Limit</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">perMinute</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">50</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">by</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;user-&gt;id</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<p>Once you have defined your rate limit, you may attach the rate limiter to your job using the <code>Illuminate\Queue\Middleware\RateLimited</code> middleware. Each time the job exceeds the rate limit, this middleware will release the job back to the queue with an appropriate delay based on the rate limit duration.</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">RateLimited</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RateLimited</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">backups</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Releasing a rate limited job back onto the queue will still increment the job's total number of <code>attempts</code>. You may wish to tune your <code>tries</code> and <code>maxExceptions</code> properties on your job class accordingly. Or, you may wish to use the <a href="#time-based-attempts"><code>retryUntil</code> method</a> to define the amount of time until the job should no longer be attempted.</p>
<p>If you do not want a job to be retried when it is rate limited, you may use the <code>dontRelease</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RateLimited</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">backups</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dontRelease</span><span style="color: #BFC7D5;">()];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
If you are using Redis, you may use the <code>Illuminate\Queue\Middleware\RateLimitedWithRedis</code> middleware, which is fine-tuned for Redis and more efficient than the basic rate limiting middleware.</p>
</div>
<h3 id="preventing-job-overlaps"><a href="#preventing-job-overlaps">Preventing Job Overlaps</a></h3>
<p>Laravel includes an <code>Illuminate\Queue\Middleware\WithoutOverlapping</code> middleware that allows you to prevent job overlaps based on an arbitrary key. This can be helpful when a queued job is modifying a resource that should only be modified by one job at a time.</p>
<p>For example, let's imagine you have a queued job that updates a user's credit score and you want to prevent credit score update job overlaps for the same user ID. To accomplish this, you can return the <code>WithoutOverlapping</code> middleware from your job's <code>middleware</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;user-&gt;id</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Any overlapping jobs of the same type will be released back to the queue. You may also specify the number of seconds that must elapse before the released job will be attempted again:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;order-&gt;id</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">releaseAfter</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you wish to immediately delete any overlapping jobs so that they will not be retried, you may use the <code>dontRelease</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;order-&gt;id</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dontRelease</span><span style="color: #BFC7D5;">()];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>The <code>WithoutOverlapping</code> middleware is powered by Laravel's atomic lock feature. Sometimes, your job may unexpectedly fail or timeout in such a way that the lock is not released. Therefore, you may explicitly define a lock expiration time using the <code>expireAfter</code> method. For example, the example below will instruct Laravel to release the <code>WithoutOverlapping</code> lock three minutes after the job has started processing:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;order-&gt;id</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">expireAfter</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">180</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The <code>WithoutOverlapping</code> middleware requires a cache driver that supports <a href="cache.html#atomic-locks">locks</a>. Currently, the <code>memcached</code>, <code>redis</code>, <code>dynamodb</code>, <code>database</code>, <code>file</code>, and <code>array</code> cache drivers support atomic locks.</p>
</div>
<h4 id="sharing-lock-keys"><a href="#sharing-lock-keys">Sharing Lock Keys Across Job Classes</a></h4>
<p>By default, the <code>WithoutOverlapping</code> middleware will only prevent overlapping jobs of the same class. So, although two different job classes may use the same lock key, they will not be prevented from overlapping. However, you can instruct Laravel to apply the key across job classes using the <code>shared</code> method:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProviderIsDown</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">            (</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&quot;</span><span style="color: #C3E88D;">status:{</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;provider</span><span style="color: #C3E88D;">}</span><span style="color: #D9F5DD;">&quot;</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">shared</span><span style="color: #BFC7D5;">(),</span></div><div class='line'><span style="color: #BFC7D5;">        ];</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProviderIsUp</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">            (</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">WithoutOverlapping</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&quot;</span><span style="color: #C3E88D;">status:{</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;provider</span><span style="color: #C3E88D;">}</span><span style="color: #D9F5DD;">&quot;</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">shared</span><span style="color: #BFC7D5;">(),</span></div><div class='line'><span style="color: #BFC7D5;">        ];</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
</div>
<h3 id="throttling-exceptions"><a href="#throttling-exceptions">Throttling Exceptions</a></h3>
<p>Laravel includes a <code>Illuminate\Queue\Middleware\ThrottlesExceptions</code> middleware that allows you to throttle exceptions. Once the job throws a given number of exceptions, all further attempts to execute the job are delayed until a specified time interval lapses. This middleware is particularly useful for jobs that interact with third-party services that are unstable.</p>
<p>For example, let's imagine a queued job that interacts with a third-party API that begins throwing exceptions. To throttle exceptions, you can return the <code>ThrottlesExceptions</code> middleware from your job's <code>middleware</code> method. Typically, this middleware should be paired with a job that implements <a href="#time-based-attempts">time based attempts</a>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">DateTime</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Determine the time at which the job should timeout.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">retryUntil</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">DateTime</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">now</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">addMinutes</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">30</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>The first constructor argument accepted by the middleware is the number of exceptions the job can throw before being throttled, while the second constructor argument is the number of seconds that should elapse before the job is attempted again once it has been throttled. In the code example above, if the job throws 10 consecutive exceptions, we will wait 5 minutes before attempting the job again, constrained by the 30-minute time limit.</p>
<p>When a job throws an exception but the exception threshold has not yet been reached, the job will typically be retried immediately. However, you may specify the number of minutes such a job should be delayed by calling the <code>backoff</code> method when attaching the middleware to the job:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">backoff</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Internally, this middleware uses Laravel's cache system to implement rate limiting, and the job's class name is utilized as the cache &quot;key&quot;. You may override this key by calling the <code>by</code> method when attaching the middleware to your job. This may be useful if you have multiple jobs interacting with the same third-party service and you would like them to share a common throttling &quot;bucket&quot;:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">by</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>By default, this middleware will throttle every exception. You can modify this behaviour by invoking the <code>when</code> method when attaching the middleware to your job. The exception will then only be throttled if closure provided to the <code>when</code> method returns <code>true</code>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\Client\</span><span style="color: #FFCB8B;">HttpClientException</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">when</span><span style="color: #BFC7D5;">(</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">fn</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$throwable</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> =&gt; </span><span style="color: #BEC5D4;">$throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">instanceof</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">HttpClientException</span></div><div class='line'><span style="color: #BFC7D5;">    )];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you would like to have the throttled exceptions reported to your application's exception handler, you can do so by invoking the <code>report</code> method when attaching the middleware to your job. Optionally, you may provide a closure to the <code>report</code> method and the exception will only be reported if the given closure returns <code>true</code>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\Client\</span><span style="color: #FFCB8B;">HttpClientException</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, object&gt;</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ThrottlesExceptions</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">))</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">report</span><span style="color: #BFC7D5;">(</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">fn</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$throwable</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> =&gt; </span><span style="color: #BEC5D4;">$throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">instanceof</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">HttpClientException</span></div><div class='line'><span style="color: #BFC7D5;">    )];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
If you are using Redis, you may use the <code>Illuminate\Queue\Middleware\ThrottlesExceptionsWithRedis</code> middleware, which is fine-tuned for Redis and more efficient than the basic exception throttling middleware.</p>
</div>
<h3 id="skipping-jobs"><a href="#skipping-jobs">Skipping Jobs</a></h3>
<p>The <code>Skip</code> middleware allows you to specify that a job should be skipped / deleted without needing to modify the job's logic. The <code>Skip::when</code> method will delete the job if the given condition evaluates to <code>true</code>, while the <code>Skip::unless</code> method will delete the job if the condition evaluates to <code>false</code>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">Skip</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">* Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Skip</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">when</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$someCondition</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    ];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>You can also pass a <code>Closure</code> to the <code>when</code> and <code>unless</code> methods for more complex conditional evaluation:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">Skip</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">* Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Skip</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">when</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">bool</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">shouldSkip</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">        }),</span></div><div class='line'><span style="color: #BFC7D5;">    ];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h2 id="dispatching-jobs"><a href="#dispatching-jobs">Dispatching Jobs</a></h2>
<p>Once you have written your job class, you may dispatch it using the <code>dispatch</code> method on the job itself. The arguments passed to the <code>dispatch</code> method will be given to the job's constructor:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Http\Controllers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Http\Controllers\</span><span style="color: #FFCB8B;">Controller</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">RedirectResponse</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">PodcastController</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">Controller</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Store a new podcast.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">store</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$request</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RedirectResponse</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">create</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">redirect</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you would like to conditionally dispatch a job, you may use the <code>dispatchIf</code> and <code>dispatchUnless</code> methods:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatchIf</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$accountActive</span><span style="color: #BFC7D5;">, </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatchUnless</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$accountSuspended</span><span style="color: #BFC7D5;">, </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<p>In new Laravel applications, the <code>sync</code> driver is the default queue driver. This driver executes jobs synchronously in the foreground of the current request, which is often convenient during local development. If you would like to actually begin queueing jobs for background processing, you may specify a different queue driver within your application's <code>config/queue.php</code> configuration file.</p>
<h3 id="delayed-dispatching"><a href="#delayed-dispatching">Delayed Dispatching</a></h3>
<p>If you would like to specify that a job should not be immediately available for processing by a queue worker, you may use the <code>delay</code> method when dispatching the job. For example, let's specify that a job should not be available for processing until 10 minutes after it has been dispatched:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Http\Controllers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Http\Controllers\</span><span style="color: #FFCB8B;">Controller</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">RedirectResponse</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">PodcastController</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">Controller</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Store a new podcast.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">store</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$request</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RedirectResponse</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">create</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">delay</span><span style="color: #BFC7D5;">(</span><span style="color: #82AAFF;">now</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">addMinutes</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">));</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">redirect</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In some cases, jobs may have a default delay configured. If you need to bypass this delay and dispatch a job for immediate processing, you may use the <code>withoutDelay</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">withoutDelay</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The Amazon SQS queue service has a maximum delay time of 15 minutes.</p>
</div>
<h4 id="dispatching-after-the-response-is-sent-to-browser"><a href="#dispatching-after-the-response-is-sent-to-browser">Dispatching After the Response is Sent to the Browser</a></h4>
<p>Alternatively, the <code>dispatchAfterResponse</code> method delays dispatching a job until after the HTTP response is sent to the user's browser if your web server is using FastCGI. This will still allow the user to begin using the application even though a queued job is still executing. This should typically only be used for jobs that take about a second, such as sending an email. Since they are processed within the current HTTP request, jobs dispatched in this fashion do not require a queue worker to be running in order for them to be processed:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">SendNotification</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">SendNotification</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatchAfterResponse</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>You may also <code>dispatch</code> a closure and chain the <code>afterResponse</code> method onto the <code>dispatch</code> helper to execute a closure after the HTTP response has been sent to the browser:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Mail\</span><span style="color: #FFCB8B;">WelcomeMessage</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Mail</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #82AAFF;"> </span><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Mail</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">to</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;"><a href="https://laravel.com/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="601401190c0f12200518010d100c054e030f0d">[email&#160;protected]</a></span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">send</span><span style="color: #BFC7D5;">(</span><span style="color: #89DDFF;">new</span><span style="color: #82AAFF;"> </span><span style="color: #FFCB8B;">WelcomeMessage</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">afterResponse</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h3 id="synchronous-dispatching"><a href="#synchronous-dispatching">Synchronous Dispatching</a></h3>
<p>If you would like to dispatch a job immediately (synchronously), you may use the <code>dispatchSync</code> method. When using this method, the job will not be queued and will be executed immediately within the current process:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Http\Controllers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Http\Controllers\</span><span style="color: #FFCB8B;">Controller</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">RedirectResponse</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">PodcastController</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">Controller</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Store a new podcast.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">store</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$request</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RedirectResponse</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">create</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Create podcast...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatchSync</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">redirect</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h3 id="jobs-and-database-transactions"><a href="#jobs-and-database-transactions">Jobs &amp; Database Transactions</a></h3>
<p>While it is perfectly fine to dispatch jobs within database transactions, you should take special care to ensure that your job will actually be able to execute successfully. When dispatching a job within a transaction, it is possible that the job will be processed by a worker before the parent transaction has committed. When this happens, any updates you have made to models or database records during the database transaction(s) may not yet be reflected in the database. In addition, any models or database records created within the transaction(s) may not exist in the database.</p>
<p>Thankfully, Laravel provides several methods of working around this problem. First, you may set the <code>after_commit</code> connection option in your queue connection's configuration array:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">after_commit</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">true</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
<p>When the <code>after_commit</code> option is <code>true</code>, you may dispatch jobs within database transactions; however, Laravel will wait until the open parent database transactions have been committed before actually dispatching the job. Of course, if no database transactions are currently open, the job will be dispatched immediately.</p>
<p>If a transaction is rolled back due to an exception that occurs during the transaction, the jobs that were dispatched during that transaction will be discarded.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Setting the <code>after_commit</code> configuration option to <code>true</code> will also cause any queued event listeners, mailables, notifications, and broadcast events to be dispatched after all open database transactions have been committed.</p>
</div>
<h4 id="specifying-commit-dispatch-behavior-inline"><a href="#specifying-commit-dispatch-behavior-inline">Specifying Commit Dispatch Behavior Inline</a></h4>
<p>If you do not set the <code>after_commit</code> queue connection configuration option to <code>true</code>, you may still indicate that a specific job should be dispatched after all open database transactions have been committed. To accomplish this, you may chain the <code>afterCommit</code> method onto your dispatch operation:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">afterCommit</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>Likewise, if the <code>after_commit</code> configuration option is set to <code>true</code>, you may indicate that a specific job should be dispatched immediately without waiting for any open database transactions to commit:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">beforeCommit</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h3 id="job-chaining"><a href="#job-chaining">Job Chaining</a></h3>
<p>Job chaining allows you to specify a list of queued jobs that should be run in sequence after the primary job has executed successfully. If one job in the sequence fails, the rest of the jobs will not be run. To execute a queued job chain, you may use the <code>chain</code> method provided by the <code>Bus</code> facade. Laravel's command bus is a lower level component that queued job dispatching is built on top of:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>In addition to chaining job class instances, you may also chain closures:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">update</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    },</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Deleting jobs using the <code>$this-&gt;delete()</code> method within the job will not prevent chained jobs from being processed. The chain will only stop executing if a job in the chain fails.</p>
</div>
<h4 id="chain-connection-queue"><a href="#chain-connection-queue">Chain Connection and Queue</a></h4>
<p>If you would like to specify the connection and queue that should be used for the chained jobs, you may use the <code>onConnection</code> and <code>onQueue</code> methods. These methods specify the queue connection and queue name that should be used unless the queued job is explicitly assigned a different connection / queue:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onConnection</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h4 id="adding-jobs-to-the-chain"><a href="#adding-jobs-to-the-chain">Adding Jobs to the Chain</a></h4>
<p>Occasionally, you may need to prepend or append a job to an existing job chain from within another job in that chain. You may accomplish this using the <code>prependToChain</code> and <code>appendToChain</code> methods:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Prepend to the current chain, run job immediately after current job...</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">prependToChain</span><span style="color: #BFC7D5;">(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">TranscribePodcast</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Append to the current chain, run job at end of chain...</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">appendToChain</span><span style="color: #BFC7D5;">(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">TranscribePodcast</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
</div>
<h4 id="chain-failures"><a href="#chain-failures">Chain Failures</a></h4>
<p>When chaining jobs, you may use the <code>catch</code> method to specify a closure that should be invoked if a job within the chain fails. The given callback will receive the <code>Throwable</code> instance that caused the job failure:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">catch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$e</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> A job within the chain has failed...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Since chain callbacks are serialized and executed at a later time by the Laravel queue, you should not use the <code>$this</code> variable within chain callbacks.</p>
</div>
<h3 id="customizing-the-queue-and-connection"><a href="#customizing-the-queue-and-connection">Customizing the Queue and Connection</a></h3>
<h4 id="dispatching-to-a-particular-queue"><a href="#dispatching-to-a-particular-queue">Dispatching to a Particular Queue</a></h4>
<p>By pushing jobs to different queues, you may &quot;categorize&quot; your queued jobs and even prioritize how many workers you assign to various queues. Keep in mind, this does not push jobs to different queue &quot;connections&quot; as defined by your queue configuration file, but only to specific queues within a single connection. To specify the queue, use the <code>onQueue</code> method when dispatching the job:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Http\Controllers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Http\Controllers\</span><span style="color: #FFCB8B;">Controller</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">RedirectResponse</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">PodcastController</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">Controller</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Store a new podcast.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">store</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$request</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RedirectResponse</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">create</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Create podcast...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">processing</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">redirect</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Alternatively, you may specify the job's queue by calling the <code>onQueue</code> method within the job's constructor:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Foundation\Queue\</span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Create a new job instance.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">()</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">processing</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h4 id="dispatching-to-a-particular-connection"><a href="#dispatching-to-a-particular-connection">Dispatching to a Particular Connection</a></h4>
<p>If your application interacts with multiple queue connections, you may specify which connection to push a job to using the <code>onConnection</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Http\Controllers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Http\Controllers\</span><span style="color: #FFCB8B;">Controller</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">RedirectResponse</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Http\</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">PodcastController</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">Controller</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Store a new podcast.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">store</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Request</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$request</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RedirectResponse</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">create</span><span style="color: #BFC7D5;">(</span><span style="color: #697098;">/*</span><span style="color: #697098;"> ... </span><span style="color: #697098;">*/</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Create podcast...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onConnection</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">sqs</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">redirect</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/podcasts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>You may chain the <code>onConnection</code> and <code>onQueue</code> methods together to specify the connection and the queue for a job:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">              </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onConnection</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">sqs</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">              </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">processing</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<p>Alternatively, you may specify the job's connection by calling the <code>onConnection</code> method within the job's constructor:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Foundation\Queue\</span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Create a new job instance.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">()</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onConnection</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">sqs</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h3 id="max-job-attempts-and-timeout"><a href="#max-job-attempts-and-timeout">Specifying Max Job Attempts / Timeout Values</a></h3>
<h4 id="max-attempts"><a href="#max-attempts">Max Attempts</a></h4>
<p>If one of your queued jobs is encountering an error, you likely do not want it to keep retrying indefinitely. Therefore, Laravel provides various ways to specify how many times or for how long a job may be attempted.</p>
<p>One approach to specifying the maximum number of times a job may be attempted is via the <code>--tries</code> switch on the Artisan command line. This will apply to all jobs processed by the worker unless the job being processed specifies the number of times it may be attempted:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--tries=3</span></div></code></pre>
</div>
<p>If a job exceeds its maximum number of attempts, it will be considered a &quot;failed&quot; job. For more information on handling failed jobs, consult the <a href="#dealing-with-failed-jobs">failed job documentation</a>. If <code>--tries=0</code> is provided to the <code>queue:work</code> command, the job will be retried indefinitely.</p>
<p>You may take a more granular approach by defining the maximum number of times a job may be attempted on the job class itself. If the maximum number of attempts is specified on the job, it will take precedence over the <code>--tries</code> value provided on the command line:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The number of times the job may be attempted.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$tries</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you need dynamic control over a particular job's maximum attempts, you may define a <code>tries</code> method on the job:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Determine number of times the job may be attempted.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">tries</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h4 id="time-based-attempts"><a href="#time-based-attempts">Time Based Attempts</a></h4>
<p>As an alternative to defining how many times a job may be attempted before it fails, you may define a time at which the job should no longer be attempted. This allows a job to be attempted any number of times within a given time frame. To define the time at which a job should no longer be attempted, add a <code>retryUntil</code> method to your job class. This method should return a <code>DateTime</code> instance:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">DateTime</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Determine the time at which the job should timeout.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">retryUntil</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">DateTime</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">now</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">addMinutes</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
You may also define a <code>tries</code> property or <code>retryUntil</code> method on your <a href="events.html#queued-event-listeners">queued event listeners</a>.</p>
</div>
<h4 id="max-exceptions"><a href="#max-exceptions">Max Exceptions</a></h4>
<p>Sometimes you may wish to specify that a job may be attempted many times, but should fail if the retries are triggered by a given number of unhandled exceptions (as opposed to being released by the <code>release</code> method directly). To accomplish this, you may define a <code>maxExceptions</code> property on your job class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Redis</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The number of times the job may be attempted.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$tries</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">25</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The maximum number of unhandled exceptions to allow before failing.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$maxExceptions</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Execute the job.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Redis</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">throttle</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">allow</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">every</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> Lock obtained, process the podcast...</span></div><div class='line'><span style="color: #BFC7D5;">        }, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> Unable to obtain lock...</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">        });</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>In this example, the job is released for ten seconds if the application is unable to obtain a Redis lock and will continue to be retried up to 25 times. However, the job will fail if three unhandled exceptions are thrown by the job.</p>
<h4 id="timeout"><a href="#timeout">Timeout</a></h4>
<p>Often, you know roughly how long you expect your queued jobs to take. For this reason, Laravel allows you to specify a &quot;timeout&quot; value. By default, the timeout value is 60 seconds. If a job is processing for longer than the number of seconds specified by the timeout value, the worker processing the job will exit with an error. Typically, the worker will be restarted automatically by a <a href="#supervisor-configuration">process manager configured on your server</a>.</p>
<p>The maximum number of seconds that jobs can run may be specified using the <code>--timeout</code> switch on the Artisan command line:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--timeout=30</span></div></code></pre>
</div>
<p>If the job exceeds its maximum attempts by continually timing out, it will be marked as failed.</p>
<p>You may also define the maximum number of seconds a job should be allowed to run on the job class itself. If the timeout is specified on the job, it will take precedence over any timeout specified on the command line:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * The number of seconds the job can run before timing out.</span></div><div class='line'><span style="color: #697098;">     *</span></div><div class='line'><span style="color: #697098;">     * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$timeout</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">120</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Sometimes, IO blocking processes such as sockets or outgoing HTTP connections may not respect your specified timeout. Therefore, when using these features, you should always attempt to specify a timeout using their APIs as well. For example, when using Guzzle, you should always specify a connection and request timeout value.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The <code>pcntl</code> PHP extension must be installed in order to specify job timeouts. In addition, a job's &quot;timeout&quot; value should always be less than its <a href="#job-expiration">&quot;retry after&quot;</a> value. Otherwise, the job may be re-attempted before it has actually finished executing or timed out.</p>
</div>
<h4 id="failing-on-timeout"><a href="#failing-on-timeout">Failing on Timeout</a></h4>
<p>If you would like to indicate that a job should be marked as <a href="#dealing-with-failed-jobs">failed</a> on timeout, you may define the <code>$failOnTimeout</code> property on the job class:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Indicate if the job should be marked as failed on timeout.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">bool</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$failOnTimeout</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">true</span><span style="color: #BFC7D5;">;</span></div></code></pre>
</div>
<h3 id="error-handling"><a href="#error-handling">Error Handling</a></h3>
<p>If an exception is thrown while the job is being processed, the job will automatically be released back onto the queue so it may be attempted again. The job will continue to be released until it has been attempted the maximum number of times allowed by your application. The maximum number of attempts is defined by the <code>--tries</code> switch used on the <code>queue:work</code> Artisan command. Alternatively, the maximum number of attempts may be defined on the job class itself. More information on running the queue worker <a href="#running-the-queue-worker">can be found below</a>.</p>
<h4 id="manually-releasing-a-job"><a href="#manually-releasing-a-job">Manually Releasing a Job</a></h4>
<p>Sometimes you may wish to manually release a job back onto the queue so that it can be attempted again at a later time. You may accomplish this by calling the <code>release</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>By default, the <code>release</code> method will release the job back onto the queue for immediate processing. However, you may instruct the queue to not make the job available for processing until a given number of seconds has elapsed by passing an integer or date instance to the <code>release</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">release</span><span style="color: #BFC7D5;">(</span><span style="color: #82AAFF;">now</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">addSeconds</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">));</span></div></code></pre>
<h4 id="manually-failing-a-job"><a href="#manually-failing-a-job">Manually Failing a Job</a></h4>
<p>Occasionally you may need to manually mark a job as &quot;failed&quot;. To do so, you may call the <code>fail</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">fail</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>If you would like to mark your job as failed because of an exception that you have caught, you may pass the exception to the <code>fail</code> method. Or, for convenience, you may pass a string error message which will be converted to an exception for you:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">fail</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$exception</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">fail</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">Something went wrong.</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
For more information on failed jobs, check out the <a href="#dealing-with-failed-jobs">documentation on dealing with job failures</a>.</p>
</div>
<h2 id="job-batching"><a href="#job-batching">Job Batching</a></h2>
<p>Laravel's job batching feature allows you to easily execute a batch of jobs and then perform some action when the batch of jobs has completed executing. Before getting started, you should create a database migration to build a table which will contain meta information about your job batches, such as their completion percentage. This migration may be generated using the <code>make:queue-batches-table</code> Artisan command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">make:queue-batches-table</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">migrate</span></div></code></pre>
</div>
<h3 id="defining-batchable-jobs"><a href="#defining-batchable-jobs">Defining Batchable Jobs</a></h3>
<p>To define a batchable job, you should <a href="#creating-jobs">create a queueable job</a> as normal; however, you should add the <code>Illuminate\Bus\Batchable</code> trait to the job class. This trait provides access to a <code>batch</code> method which may be used to retrieve the current batch that the job is executing within:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Bus\</span><span style="color: #FFCB8B;">Batchable</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Foundation\Queue\</span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ImportCsv</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Batchable</span><span style="color: #BFC7D5;">, </span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Execute the job.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">if</span><span style="color: #BFC7D5;"> (</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancelled</span><span style="color: #BFC7D5;">()) {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> Determine if the batch has been cancelled...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">        }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Import a portion of the CSV file...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h3 id="dispatching-batches"><a href="#dispatching-batches">Dispatching Batches</a></h3>
<p>To dispatch a batch of jobs, you should use the <code>batch</code> method of the <code>Bus</code> facade. Of course, batching is primarily useful when combined with completion callbacks. So, you may use the <code>then</code>, <code>catch</code>, and <code>finally</code> methods to define completion callbacks for the batch. Each of these callbacks will receive an <code>Illuminate\Bus\Batch</code> instance when they are invoked. In this example, we will imagine we are queueing a batch of jobs that each process a given number of rows from a CSV file:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Bus\</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">100</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">101</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">200</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">201</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">300</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">301</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">400</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportCsv</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">401</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">500</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">before</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> The batch has been created but no jobs have been added...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">progress</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> A single job has completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> All jobs completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">catch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;">, </span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$e</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> First batch job failure detected...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">finally</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> The batch has finished executing...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;id</span><span style="color: #BFC7D5;">;</span></div></code></pre>
<p>The batch's ID, which may be accessed via the <code>$batch-&gt;id</code> property, may be used to <a href="#inspecting-batches">query the Laravel command bus</a> for information about the batch after it has been dispatched.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Since batch callbacks are serialized and executed at a later time by the Laravel queue, you should not use the <code>$this</code> variable within the callbacks. In addition, since batched jobs are wrapped within database transactions, database statements that trigger implicit commits should not be executed within the jobs.</p>
</div>
<h4 id="naming-batches"><a href="#naming-batches">Naming Batches</a></h4>
<p>Some tools such as Laravel Horizon and Laravel Telescope may provide more user-friendly debug information for batches if batches are named. To assign an arbitrary name to a batch, you may call the <code>name</code> method while defining the batch:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> All jobs completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">name</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">Import CSV</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h4 id="batch-connection-queue"><a href="#batch-connection-queue">Batch Connection and Queue</a></h4>
<p>If you would like to specify the connection and queue that should be used for the batched jobs, you may use the <code>onConnection</code> and <code>onQueue</code> methods. All batched jobs must execute within the same connection and queue:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> All jobs completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onConnection</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">redis</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">imports</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h3 id="chains-and-batches"><a href="#chains-and-batches">Chains and Batches</a></h3>
<p>You may define a set of <a href="#job-chaining">chained jobs</a> within a batch by placing the chained jobs within an array. For example, we may execute two job chains in parallel and execute a callback when both job chains have finished processing:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Bus\</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    [</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    ],</span></div><div class='line'><span style="color: #BFC7D5;">    [</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    ],</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>Conversely, you may run batches of jobs within a <a href="#job-chaining">chain</a> by defining batches within the chain. For example, you could first run a batch of jobs to release multiple podcasts then a batch of jobs to send the release notifications:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">FlushPodcastCache</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">FlushPodcastCache</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    ]),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">SendPodcastReleaseNotification</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    ]),</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h3 id="adding-jobs-to-batches"><a href="#adding-jobs-to-batches">Adding Jobs to Batches</a></h3>
<p>Sometimes it may be useful to add additional jobs to a batch from within a batched job. This pattern can be useful when you need to batch thousands of jobs which may take too long to dispatch during a web request. So, instead, you may wish to dispatch an initial batch of &quot;loader&quot; jobs that hydrate the batch with even more jobs:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">LoadImportBatch</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">LoadImportBatch</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">LoadImportBatch</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> All jobs completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">name</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">Import Contacts</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>In this example, we will use the <code>LoadImportBatch</code> job to hydrate the batch with additional jobs. To accomplish this, we may use the <code>add</code> method on the batch instance that may be accessed via the job's <code>batch</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ImportContacts</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\</span><span style="color: #FFCB8B;">Collection</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">if</span><span style="color: #BFC7D5;"> (</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancelled</span><span style="color: #BFC7D5;">()) {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">add</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">Collection</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">times</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1000</span><span style="color: #BFC7D5;">, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ImportContacts</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">    }));</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
You may only add jobs to a batch from within a job that belongs to the same batch.</p>
</div>
<h3 id="inspecting-batches"><a href="#inspecting-batches">Inspecting Batches</a></h3>
<p>The <code>Illuminate\Bus\Batch</code> instance that is provided to batch completion callbacks has a variety of properties and methods to assist you in interacting with and inspecting a given batch of jobs:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The UUID of the batch...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;id</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The name of the batch (if applicable)...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;name</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The number of jobs assigned to the batch...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;totalJobs</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The number of jobs that have not been processed by the queue...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;pendingJobs</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The number of jobs that have failed...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;failedJobs</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The number of jobs that have been processed thus far...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">processedJobs</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> The completion percentage of the batch (0-100)...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">progress</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> Indicates if the batch has finished executing...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">finished</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> Cancel the execution of the batch...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancel</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> Indicates if the batch has been cancelled...</span></div><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancelled</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h4 id="returning-batches-from-routes"><a href="#returning-batches-from-routes">Returning Batches From Routes</a></h4>
<p>All <code>Illuminate\Bus\Batch</code> instances are JSON serializable, meaning you can return them directly from one of your application's routes to retrieve a JSON payload containing information about the batch, including its completion progress. This makes it convenient to display information about the batch's completion progress in your application's UI.</p>
<p>To retrieve a batch by its ID, you may use the <code>Bus</code> facade's <code>findBatch</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Route</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Route</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">get</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">/batch/{batchId}</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">, </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #C792EA;">string</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batchId</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">findBatch</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$batchId</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<h3 id="cancelling-batches"><a href="#cancelling-batches">Cancelling Batches</a></h3>
<p>Sometimes you may need to cancel a given batch's execution. This can be accomplished by calling the <code>cancel</code> method on the <code>Illuminate\Bus\Batch</code> instance:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Execute the job.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">if</span><span style="color: #BFC7D5;"> (</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;user-&gt;</span><span style="color: #82AAFF;">exceedsImportLimit</span><span style="color: #BFC7D5;">()) {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancel</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">if</span><span style="color: #BFC7D5;"> (</span><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancelled</span><span style="color: #BFC7D5;">()) {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>As you may have noticed in the previous examples, batched jobs should typically determine if their corresponding batch has been cancelled before continuing execution. However, for convenience, you may assign the <code>SkipIfBatchCancelled</code> <a href="#job-middleware">middleware</a> to the job instead. As its name indicates, this middleware will instruct Laravel to not process the job if its corresponding batch has been cancelled:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Middleware\</span><span style="color: #FFCB8B;">SkipIfBatchCancelled</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Get the middleware the job should pass through.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">middleware</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">SkipIfBatchCancelled</span><span style="color: #BFC7D5;">];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h3 id="batch-failures"><a href="#batch-failures">Batch Failures</a></h3>
<p>When a batched job fails, the <code>catch</code> callback (if assigned) will be invoked. This callback is only invoked for the first job that fails within the batch.</p>
<h4 id="allowing-failures"><a href="#allowing-failures">Allowing Failures</a></h4>
<p>When a job within a batch fails, Laravel will automatically mark the batch as &quot;cancelled&quot;. If you wish, you may disable this behavior so that a job failure does not automatically mark the batch as cancelled. This may be accomplished by calling the <code>allowFailures</code> method while dispatching the batch:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">batch</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">])</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">then</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> All jobs completed successfully...</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">allowFailures</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h4 id="retrying-failed-batch-jobs"><a href="#retrying-failed-batch-jobs">Retrying Failed Batch Jobs</a></h4>
<p>For convenience, Laravel provides a <code>queue:retry-batch</code> Artisan command that allows you to easily retry all of the failed jobs for a given batch. The <code>queue:retry-batch</code> command accepts the UUID of the batch whose failed jobs should be retried:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:retry-batch</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">32dbc76c-4f82-4749-b610-a639fe0099b5</span></div></code></pre>
</div>
<h3 id="pruning-batches"><a href="#pruning-batches">Pruning Batches</a></h3>
<p>Without pruning, the <code>job_batches</code> table can accumulate records very quickly. To mitigate this, you should <a href="scheduling.html">schedule</a> the <code>queue:prune-batches</code> Artisan command to run daily:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Schedule</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Schedule</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">command</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue:prune-batches</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">daily</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>By default, all finished batches that are more than 24 hours old will be pruned. You may use the <code>hours</code> option when calling the command to determine how long to retain batch data. For example, the following command will delete all batches that finished over 48 hours ago:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Schedule</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Schedule</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">command</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue:prune-batches --hours=48</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">daily</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>Sometimes, your <code>jobs_batches</code> table may accumulate batch records for batches that never completed successfully, such as batches where a job failed and that job was never retried successfully. You may instruct the <code>queue:prune-batches</code> command to prune these unfinished batch records using the <code>unfinished</code> option:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Schedule</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Schedule</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">command</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue:prune-batches --hours=48 --unfinished=72</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">daily</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<p>Likewise, your <code>jobs_batches</code> table may also accumulate batch records for cancelled batches. You may instruct the <code>queue:prune-batches</code> command to prune these cancelled batch records using the <code>cancelled</code> option:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Schedule</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Schedule</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">command</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue:prune-batches --hours=48 --cancelled=72</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">daily</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h3 id="storing-batches-in-dynamodb"><a href="#storing-batches-in-dynamodb">Storing Batches in DynamoDB</a></h3>
<p>Laravel also provides support for storing batch meta information in <a href="https://aws.amazon.com/dynamodb">DynamoDB</a> instead of a relational database. However, you will need to manually create a DynamoDB table to store all of the batch records.</p>
<p>Typically, this table should be named <code>job_batches</code>, but you should name the table based on the value of the <code>queue.batching.table</code> configuration value within your application's <code>queue</code> configuration file.</p>
<h4 id="dynamodb-batch-table-configuration"><a href="#dynamodb-batch-table-configuration">DynamoDB Batch Table Configuration</a></h4>
<p>The <code>job_batches</code> table should have a string primary partition key named <code>application</code> and a string primary sort key named <code>id</code>. The <code>application</code> portion of the key will contain your application's name as defined by the <code>name</code> configuration value within your application's <code>app</code> configuration file. Since the application name is part of the DynamoDB table's key, you can use the same table to store job batches for multiple Laravel applications.</p>
<p>In addition, you may define <code>ttl</code> attribute for your table if you would like to take advantage of <a href="#pruning-batches-in-dynamodb">automatic batch pruning</a>.</p>
<h4 id="dynamodb-configuration"><a href="#dynamodb-configuration">DynamoDB Configuration</a></h4>
<p>Next, install the AWS SDK so that your Laravel application can communicate with Amazon DynamoDB:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">composer </span><span style="color: #BFC7D5;">require</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">aws/aws-sdk-php</span></div></code></pre>
</div>
<p>Then, set the <code>queue.batching.driver</code> configuration option's value to <code>dynamodb</code>. In addition, you should define <code>key</code>, <code>secret</code>, and <code>region</code> configuration options within the <code>batching</code> configuration array. These options will be used to authenticate with AWS. When using the <code>dynamodb</code> driver, the <code>queue.batching.database</code> configuration option is unnecessary:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">batching</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">QUEUE_BATCHING_DRIVER</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">dynamodb</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_ACCESS_KEY_ID</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">secret</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_SECRET_ACCESS_KEY</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">region</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_DEFAULT_REGION</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">us-east-1</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">table</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">job_batches</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
</div>
<h4 id="pruning-batches-in-dynamodb"><a href="#pruning-batches-in-dynamodb">Pruning Batches in DynamoDB</a></h4>
<p>When utilizing <a href="https://aws.amazon.com/dynamodb">DynamoDB</a> to store job batch information, the typical pruning commands used to prune batches stored in a relational database will not work. Instead, you may utilize <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/TTL.html">DynamoDB's native TTL functionality</a> to automatically remove records for old batches.</p>
<p>If you defined your DynamoDB table with a <code>ttl</code> attribute, you may define configuration parameters to instruct Laravel how to prune batch records. The <code>queue.batching.ttl_attribute</code> configuration value defines the name of the attribute holding the TTL, while the <code>queue.batching.ttl</code> configuration value defines the number of seconds after which a batch record can be removed from the DynamoDB table, relative to the last time the record was updated:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">batching</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">QUEUE_FAILED_DRIVER</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">dynamodb</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_ACCESS_KEY_ID</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">secret</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_SECRET_ACCESS_KEY</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">region</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_DEFAULT_REGION</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">us-east-1</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">table</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">job_batches</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">ttl_attribute</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">ttl</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">ttl</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">60</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">24</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">*</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">7</span><span style="color: #BFC7D5;">, </span><span style="color: #697098;">//</span><span style="color: #697098;"> 7 days...</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
</div>
<h2 id="queueing-closures"><a href="#queueing-closures">Queueing Closures</a></h2>
<p>Instead of dispatching a job class to the queue, you may also dispatch a closure. This is great for quick, simple tasks that need to be executed outside of the current request cycle. When dispatching closures to the queue, the closure's code content is cryptographically signed so that it can not be modified in transit:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> App\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">find</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #82AAFF;"> </span><span style="color: #C792EA;">use</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #BFC7D5;">$</span><span style="color: #BEC5D4;">podcast</span><span style="color: #D9F5DD;">)</span><span style="color: #82AAFF;"> </span><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #BFC7D5;">$</span><span style="color: #BEC5D4;">podcast</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">publish</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<p>Using the <code>catch</code> method, you may provide a closure that should be executed if the queued closure fails to complete successfully after exhausting all of your queue's <a href="#max-job-attempts-and-timeout">configured retry attempts</a>:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #82AAFF;"> </span><span style="color: #C792EA;">use</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #BFC7D5;">$</span><span style="color: #BEC5D4;">podcast</span><span style="color: #D9F5DD;">)</span><span style="color: #82AAFF;"> </span><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #BFC7D5;">$</span><span style="color: #BEC5D4;">podcast</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">publish</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">})</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">catch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$e</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> This job has failed...</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Since <code>catch</code> callbacks are serialized and executed at a later time by the Laravel queue, you should not use the <code>$this</code> variable within <code>catch</code> callbacks.</p>
</div>
<h2 id="running-the-queue-worker"><a href="#running-the-queue-worker">Running the Queue Worker</a></h2>
<h3 id="the-queue-work-command"><a href="#the-queue-work-command">The <code>queue:work</code> Command</a></h3>
<p>Laravel includes an Artisan command that will start a queue worker and process new jobs as they are pushed onto the queue. You may run the worker using the <code>queue:work</code> Artisan command. Note that once the <code>queue:work</code> command has started, it will continue to run until it is manually stopped or you close your terminal:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span></div></code></pre>
</div>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
To keep the <code>queue:work</code> process running permanently in the background, you should use a process monitor such as <a href="#supervisor-configuration">Supervisor</a> to ensure that the queue worker does not stop running.</p>
</div>
<p>You may include the <code>-v</code> flag when invoking the <code>queue:work</code> command if you would like the processed job IDs to be included in the command's output:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">-v</span></div></code></pre>
</div>
<p>Remember, queue workers are long-lived processes and store the booted application state in memory. As a result, they will not notice changes in your code base after they have been started. So, during your deployment process, be sure to <a href="#queue-workers-and-deployment">restart your queue workers</a>. In addition, remember that any static state created or modified by your application will not be automatically reset between jobs.</p>
<p>Alternatively, you may run the <code>queue:listen</code> command. When using the <code>queue:listen</code> command, you don't have to manually restart the worker when you want to reload your updated code or reset the application state; however, this command is significantly less efficient than the <code>queue:work</code> command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:listen</span></div></code></pre>
</div>
<h4 id="running-multiple-queue-workers"><a href="#running-multiple-queue-workers">Running Multiple Queue Workers</a></h4>
<p>To assign multiple workers to a queue and process jobs concurrently, you should simply start multiple <code>queue:work</code> processes. This can either be done locally via multiple tabs in your terminal or in production using your process manager's configuration settings. <a href="#supervisor-configuration">When using Supervisor</a>, you may use the <code>numprocs</code> configuration value.</p>
<h4 id="specifying-the-connection-queue"><a href="#specifying-the-connection-queue">Specifying the Connection and Queue</a></h4>
<p>You may also specify which queue connection the worker should utilize. The connection name passed to the <code>work</code> command should correspond to one of the connections defined in your <code>config/queue.php</code> configuration file:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis</span></div></code></pre>
</div>
<p>By default, the <code>queue:work</code> command only processes jobs for the default queue on a given connection. However, you may customize your queue worker even further by only processing particular queues for a given connection. For example, if all of your emails are processed in an <code>emails</code> queue on your <code>redis</code> queue connection, you may issue the following command to start a worker that only processes that queue:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--queue=emails</span></div></code></pre>
</div>
<h4 id="processing-a-specified-number-of-jobs"><a href="#processing-a-specified-number-of-jobs">Processing a Specified Number of Jobs</a></h4>
<p>The <code>--once</code> option may be used to instruct the worker to only process a single job from the queue:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--once</span></div></code></pre>
</div>
<p>The <code>--max-jobs</code> option may be used to instruct the worker to process the given number of jobs and then exit. This option may be useful when combined with <a href="#supervisor-configuration">Supervisor</a> so that your workers are automatically restarted after processing a given number of jobs, releasing any memory they may have accumulated:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--max-jobs=1000</span></div></code></pre>
</div>
<h4 id="processing-all-queued-jobs-then-exiting"><a href="#processing-all-queued-jobs-then-exiting">Processing All Queued Jobs and Then Exiting</a></h4>
<p>The <code>--stop-when-empty</code> option may be used to instruct the worker to process all jobs and then exit gracefully. This option can be useful when processing Laravel queues within a Docker container if you wish to shutdown the container after the queue is empty:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--stop-when-empty</span></div></code></pre>
</div>
<h4 id="processing-jobs-for-a-given-number-of-seconds"><a href="#processing-jobs-for-a-given-number-of-seconds">Processing Jobs for a Given Number of Seconds</a></h4>
<p>The <code>--max-time</code> option may be used to instruct the worker to process jobs for the given number of seconds and then exit. This option may be useful when combined with <a href="#supervisor-configuration">Supervisor</a> so that your workers are automatically restarted after processing jobs for a given amount of time, releasing any memory they may have accumulated:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">#</span><span style="color: #697098;"> Process jobs for one hour and then exit...</span></div><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--max-time=3600</span></div></code></pre>
</div>
<h4 id="worker-sleep-duration"><a href="#worker-sleep-duration">Worker Sleep Duration</a></h4>
<p>When jobs are available on the queue, the worker will keep processing jobs with no delay in between jobs. However, the <code>sleep</code> option determines how many seconds the worker will &quot;sleep&quot; if there are no jobs available. Of course, while sleeping, the worker will not process any new jobs:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--sleep=3</span></div></code></pre>
</div>
<h4 id="maintenance-mode-queues"><a href="#maintenance-mode-queues">Maintenance Mode and Queues</a></h4>
<p>While your application is in <a href="configuration.html#maintenance-mode">maintenance mode</a>, no queued jobs will be handled. The jobs will continue to be handled as normal once the application is out of maintenance mode.</p>
<p>To force your queue workers to process jobs even if maintenance mode is enabled, you may use <code>--force</code> option:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--force</span></div></code></pre>
</div>
<h4 id="resource-considerations"><a href="#resource-considerations">Resource Considerations</a></h4>
<p>Daemon queue workers do not &quot;reboot&quot; the framework before processing each job. Therefore, you should release any heavy resources after each job completes. For example, if you are doing image manipulation with the GD library, you should free the memory with <code>imagedestroy</code> when you are done processing the image.</p>
<h3 id="queue-priorities"><a href="#queue-priorities">Queue Priorities</a></h3>
<p>Sometimes you may wish to prioritize how your queues are processed. For example, in your <code>config/queue.php</code> configuration file, you may set the default <code>queue</code> for your <code>redis</code> connection to <code>low</code>. However, occasionally you may wish to push a job to a <code>high</code> priority queue like so:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #82AAFF;">dispatch</span><span style="color: #BFC7D5;">((</span><span style="color: #89DDFF;">new</span><span style="color: #82AAFF;"> </span><span style="color: #FFCB8B;">Job</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">onQueue</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">high</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">));</span></div></code></pre>
<p>To start a worker that verifies that all of the <code>high</code> queue jobs are processed before continuing to any jobs on the <code>low</code> queue, pass a comma-delimited list of queue names to the <code>work</code> command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--queue=high,low</span></div></code></pre>
</div>
<h3 id="queue-workers-and-deployment"><a href="#queue-workers-and-deployment">Queue Workers and Deployment</a></h3>
<p>Since queue workers are long-lived processes, they will not notice changes to your code without being restarted. So, the simplest way to deploy an application using queue workers is to restart the workers during your deployment process. You may gracefully restart all of the workers by issuing the <code>queue:restart</code> command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:restart</span></div></code></pre>
</div>
<p>This command will instruct all queue workers to gracefully exit after they finish processing their current job so that no existing jobs are lost. Since the queue workers will exit when the <code>queue:restart</code> command is executed, you should be running a process manager such as <a href="#supervisor-configuration">Supervisor</a> to automatically restart the queue workers.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The queue uses the <a href="cache.html">cache</a> to store restart signals, so you should verify that a cache driver is properly configured for your application before using this feature.</p>
</div>
<h3 id="job-expirations-and-timeouts"><a href="#job-expirations-and-timeouts">Job Expirations and Timeouts</a></h3>
<h4 id="job-expiration"><a href="#job-expiration">Job Expiration</a></h4>
<p>In your <code>config/queue.php</code> configuration file, each queue connection defines a <code>retry_after</code> option. This option specifies how many seconds the queue connection should wait before retrying a job that is being processed. For example, if the value of <code>retry_after</code> is set to <code>90</code>, the job will be released back onto the queue if it has been processing for 90 seconds without being released or deleted. Typically, you should set the <code>retry_after</code> value to the maximum number of seconds your jobs should reasonably take to complete processing.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The only queue connection which does not contain a <code>retry_after</code> value is Amazon SQS. SQS will retry the job based on the <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/AboutVT.html">Default Visibility Timeout</a> which is managed within the AWS console.</p>
</div>
<h4 id="worker-timeouts"><a href="#worker-timeouts">Worker Timeouts</a></h4>
<p>The <code>queue:work</code> Artisan command exposes a <code>--timeout</code> option. By default, the <code>--timeout</code> value is 60 seconds. If a job is processing for longer than the number of seconds specified by the timeout value, the worker processing the job will exit with an error. Typically, the worker will be restarted automatically by a <a href="#supervisor-configuration">process manager configured on your server</a>:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--timeout=60</span></div></code></pre>
</div>
<p>The <code>retry_after</code> configuration option and the <code>--timeout</code> CLI option are different, but work together to ensure that jobs are not lost and that jobs are only successfully processed once.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
The <code>--timeout</code> value should always be at least several seconds shorter than your <code>retry_after</code> configuration value. This will ensure that a worker processing a frozen job is always terminated before the job is retried. If your <code>--timeout</code> option is longer than your <code>retry_after</code> configuration value, your jobs may be processed twice.</p>
</div>
<h2 id="supervisor-configuration"><a href="#supervisor-configuration">Supervisor Configuration</a></h2>
<p>In production, you need a way to keep your <code>queue:work</code> processes running. A <code>queue:work</code> process may stop running for a variety of reasons, such as an exceeded worker timeout or the execution of the <code>queue:restart</code> command.</p>
<p>For this reason, you need to configure a process monitor that can detect when your <code>queue:work</code> processes exit and automatically restart them. In addition, process monitors can allow you to specify how many <code>queue:work</code> processes you would like to run concurrently. Supervisor is a process monitor commonly used in Linux environments and we will discuss how to configure it in the following documentation.</p>
<h4 id="installing-supervisor"><a href="#installing-supervisor">Installing Supervisor</a></h4>
<p>Supervisor is a process monitor for the Linux operating system, and will automatically restart your <code>queue:work</code> processes if they fail. To install Supervisor on Ubuntu, you may use the following command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">sudo </span><span style="color: #BFC7D5;">apt-get</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">install</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">supervisor</span></div></code></pre>
</div>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
If configuring and managing Supervisor yourself sounds overwhelming, consider using <a href="https://forge.laravel.com/">Laravel Forge</a>, which will automatically install and configure Supervisor for your production Laravel projects.</p>
</div>
<h4 id="configuring-supervisor"><a href="#configuring-supervisor">Configuring Supervisor</a></h4>
<p>Supervisor configuration files are typically stored in the <code>/etc/supervisor/conf.d</code> directory. Within this directory, you may create any number of configuration files that instruct supervisor how your processes should be monitored. For example, let's create a <code>laravel-worker.conf</code> file that starts and monitors <code>queue:work</code> processes:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="ini" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">[program:laravel-worker]</span></div><div class='line'><span style="color: #C792EA;">process_name</span><span style="color: #BFC7D5;">=%(program_name)s_%(process_num)02d</span></div><div class='line'><span style="color: #C792EA;">command</span><span style="color: #BFC7D5;">=php /home/forge/app.com/artisan queue:work sqs --</span><span style="color: #C792EA;">sleep</span><span style="color: #BFC7D5;">=3 --</span><span style="color: #C792EA;">tries</span><span style="color: #BFC7D5;">=3 --</span><span style="color: #C792EA;">max-time</span><span style="color: #BFC7D5;">=3600</span></div><div class='line'><span style="color: #C792EA;">autostart</span><span style="color: #BFC7D5;">=true</span></div><div class='line'><span style="color: #C792EA;">autorestart</span><span style="color: #BFC7D5;">=true</span></div><div class='line'><span style="color: #C792EA;">stopasgroup</span><span style="color: #BFC7D5;">=true</span></div><div class='line'><span style="color: #C792EA;">killasgroup</span><span style="color: #BFC7D5;">=true</span></div><div class='line'><span style="color: #C792EA;">user</span><span style="color: #BFC7D5;">=forge</span></div><div class='line'><span style="color: #C792EA;">numprocs</span><span style="color: #BFC7D5;">=8</span></div><div class='line'><span style="color: #C792EA;">redirect_stderr</span><span style="color: #BFC7D5;">=true</span></div><div class='line'><span style="color: #C792EA;">stdout_logfile</span><span style="color: #BFC7D5;">=/home/forge/app.com/worker.log</span></div><div class='line'><span style="color: #C792EA;">stopwaitsecs</span><span style="color: #BFC7D5;">=3600</span></div></code></pre>
</div>
<p>In this example, the <code>numprocs</code> directive will instruct Supervisor to run eight <code>queue:work</code> processes and monitor all of them, automatically restarting them if they fail. You should change the <code>command</code> directive of the configuration to reflect your desired queue connection and worker options.</p>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
You should ensure that the value of <code>stopwaitsecs</code> is greater than the number of seconds consumed by your longest running job. Otherwise, Supervisor may kill the job before it is finished processing.</p>
</div>
<h4 id="starting-supervisor"><a href="#starting-supervisor">Starting Supervisor</a></h4>
<p>Once the configuration file has been created, you may update the Supervisor configuration and start the processes using the following commands:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">sudo </span><span style="color: #BFC7D5;">supervisorctl</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">reread</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">sudo </span><span style="color: #BFC7D5;">supervisorctl</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">update</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">sudo </span><span style="color: #BFC7D5;">supervisorctl</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">start</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&quot;</span><span style="color: #C3E88D;">laravel-worker:*</span><span style="color: #D9F5DD;">&quot;</span></div></code></pre>
</div>
<p>For more information on Supervisor, consult the <a href="http://supervisord.org/index.html">Supervisor documentation</a>.</p>
<h2 id="dealing-with-failed-jobs"><a href="#dealing-with-failed-jobs">Dealing With Failed Jobs</a></h2>
<p>Sometimes your queued jobs will fail. Don't worry, things don't always go as planned! Laravel includes a convenient way to <a href="#max-job-attempts-and-timeout">specify the maximum number of times a job should be attempted</a>. After an asynchronous job has exceeded this number of attempts, it will be inserted into the <code>failed_jobs</code> database table. <a href="queues.html#synchronous-dispatching">Synchronously dispatched jobs</a> that fail are not stored in this table and their exceptions are immediately handled by the application.</p>
<p>A migration to create the <code>failed_jobs</code> table is typically already present in new Laravel applications. However, if your application does not contain a migration for this table, you may use the <code>make:queue-failed-table</code> command to create the migration:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">make:queue-failed-table</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">migrate</span></div></code></pre>
</div>
<p>When running a <a href="#running-the-queue-worker">queue worker</a> process, you may specify the maximum number of times a job should be attempted using the <code>--tries</code> switch on the <code>queue:work</code> command. If you do not specify a value for the <code>--tries</code> option, jobs will only be attempted once or as many times as specified by the job class' <code>$tries</code> property:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--tries=3</span></div></code></pre>
</div>
<p>Using the <code>--backoff</code> option, you may specify how many seconds Laravel should wait before retrying a job that has encountered an exception. By default, a job is immediately released back onto the queue so that it may be attempted again:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:work</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--tries=3</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--backoff=3</span></div></code></pre>
</div>
<p>If you would like to configure how many seconds Laravel should wait before retrying a job that has encountered an exception on a per-job basis, you may do so by defining a <code>backoff</code> property on your job class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * The number of seconds to wait before retrying the job.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$backoff</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">;</span></div></code></pre>
<p>If you require more complex logic for determining the job's backoff time, you may define a <code>backoff</code> method on your job class:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">* Calculate the number of seconds to wait before retrying the job.</span></div><div class='line'><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">backoff</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">int</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>You may easily configure &quot;exponential&quot; backoffs by returning an array of backoff values from the <code>backoff</code> method. In this example, the retry delay will be 1 second for the first retry, 5 seconds for the second retry, 10 seconds for the third retry, and 10 seconds for every subsequent retry if there are more attempts remaining:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">* Calculate the number of seconds to wait before retrying the job.</span></div><div class='line'><span style="color: #697098;">*</span></div><div class='line'><span style="color: #697098;">* </span><span style="color: #C792EA;">@return</span><span style="color: #697098;"> </span><span style="color: #C792EA;">array</span><span style="color: #697098;">&lt;</span><span style="color: #C792EA;">int</span><span style="color: #697098;">, int&gt;</span></div><div class='line'><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">backoff</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">array</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> [</span><span style="color: #F78C6C;">1</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">5</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">];</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h3 id="cleaning-up-after-failed-jobs"><a href="#cleaning-up-after-failed-jobs">Cleaning Up After Failed Jobs</a></h3>
<p>When a particular job fails, you may want to send an alert to your users or revert any actions that were partially completed by the job. To accomplish this, you may define a <code>failed</code> method on your job class. The <code>Throwable</code> instance that caused the job to fail will be passed to the <code>failed</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Jobs;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Models\</span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Services\</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Contracts\Queue\</span><span style="color: #FFCB8B;">ShouldQueue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Foundation\Queue\</span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ProcessPodcast</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">implements</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ShouldQueue</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Queueable</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Create a new job instance.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">__construct</span><span style="color: #D9F5DD;">(</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">Podcast</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$podcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {}</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Execute the job.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">handle</span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">AudioProcessor</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$processor</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Process uploaded podcast...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Handle a job failure.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">failed</span><span style="color: #D9F5DD;">(</span><span style="color: #89DDFF;">?</span><span style="color: #FFCB8B;">Throwable</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$exception</span><span style="color: #D9F5DD;">)</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Send user notification of failure, etc...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
A new instance of the job is instantiated before invoking the <code>failed</code> method; therefore, any class property modifications that may have occurred within the <code>handle</code> method will be lost.</p>
</div>
<h3 id="retrying-failed-jobs"><a href="#retrying-failed-jobs">Retrying Failed Jobs</a></h3>
<p>To view all of the failed jobs that have been inserted into your <code>failed_jobs</code> database table, you may use the <code>queue:failed</code> Artisan command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:failed</span></div></code></pre>
</div>
<p>The <code>queue:failed</code> command will list the job ID, connection, queue, failure time, and other information about the job. The job ID may be used to retry the failed job. For instance, to retry a failed job that has an ID of <code>ce7bb17c-cdd8-41f0-a8ec-7b4fef4e5ece</code>, issue the following command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:retry</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">ce7bb17c-cdd8-41f0-a8ec-7b4fef4e5ece</span></div></code></pre>
</div>
<p>If necessary, you may pass multiple IDs to the command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:retry</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">ce7bb17c-cdd8-41f0-a8ec-7b4fef4e5ece</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">91401d2c-0784-4f43-824c-34f94a33c24d</span></div></code></pre>
</div>
<p>You may also retry all of the failed jobs for a particular queue:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:retry</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--queue=name</span></div></code></pre>
</div>
<p>To retry all of your failed jobs, execute the <code>queue:retry</code> command and pass <code>all</code> as the ID:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:retry</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">all</span></div></code></pre>
</div>
<p>If you would like to delete a failed job, you may use the <code>queue:forget</code> command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:forget</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">91401d2c-0784-4f43-824c-34f94a33c24d</span></div></code></pre>
</div>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
When using <a href="horizon.html">Horizon</a>, you should use the <code>horizon:forget</code> command to delete a failed job instead of the <code>queue:forget</code> command.</p>
</div>
<p>To delete all of your failed jobs from the <code>failed_jobs</code> table, you may use the <code>queue:flush</code> command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:flush</span></div></code></pre>
</div>
<h3 id="ignoring-missing-models"><a href="#ignoring-missing-models">Ignoring Missing Models</a></h3>
<p>When injecting an Eloquent model into a job, the model is automatically serialized before being placed on the queue and re-retrieved from the database when the job is processed. However, if the model has been deleted while the job was waiting to be processed by a worker, your job may fail with a <code>ModelNotFoundException</code>.</p>
<p>For convenience, you may choose to automatically delete jobs with missing models by setting your job's <code>deleteWhenMissingModels</code> property to <code>true</code>. When this property is set to <code>true</code>, Laravel will quietly discard the job without raising an exception:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Delete the job if its models no longer exist.</span></div><div class='line'><span style="color: #697098;"> *</span></div><div class='line'><span style="color: #697098;"> * </span><span style="color: #C792EA;">@var</span><span style="color: #697098;"> </span><span style="color: #C792EA;">bool</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$deleteWhenMissingModels</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">true</span><span style="color: #BFC7D5;">;</span></div></code></pre>
<h3 id="pruning-failed-jobs"><a href="#pruning-failed-jobs">Pruning Failed Jobs</a></h3>
<p>You may prune the records in your application's <code>failed_jobs</code> table by invoking the <code>queue:prune-failed</code> Artisan command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:prune-failed</span></div></code></pre>
</div>
<p>By default, all the failed job records that are more than 24 hours old will be pruned. If you provide the <code>--hours</code> option to the command, only the failed job records that were inserted within the last N number of hours will be retained. For example, the following command will delete all the failed job records that were inserted more than 48 hours ago:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:prune-failed</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--hours=48</span></div></code></pre>
</div>
<h3 id="storing-failed-jobs-in-dynamodb"><a href="#storing-failed-jobs-in-dynamodb">Storing Failed Jobs in DynamoDB</a></h3>
<p>Laravel also provides support for storing your failed job records in <a href="https://aws.amazon.com/dynamodb">DynamoDB</a> instead of a relational database table. However, you must manually create a DynamoDB table to store all of the failed job records. Typically, this table should be named <code>failed_jobs</code>, but you should name the table based on the value of the <code>queue.failed.table</code> configuration value within your application's <code>queue</code> configuration file.</p>
<p>The <code>failed_jobs</code> table should have a string primary partition key named <code>application</code> and a string primary sort key named <code>uuid</code>. The <code>application</code> portion of the key will contain your application's name as defined by the <code>name</code> configuration value within your application's <code>app</code> configuration file. Since the application name is part of the DynamoDB table's key, you can use the same table to store failed jobs for multiple Laravel applications.</p>
<p>In addition, ensure that you install the AWS SDK so that your Laravel application can communicate with Amazon DynamoDB:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">composer </span><span style="color: #BFC7D5;">require</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">aws/aws-sdk-php</span></div></code></pre>
</div>
<p>Next, set the <code>queue.failed.driver</code> configuration option's value to <code>dynamodb</code>. In addition, you should define <code>key</code>, <code>secret</code>, and <code>region</code> configuration options within the failed job configuration array. These options will be used to authenticate with AWS. When using the <code>dynamodb</code> driver, the <code>queue.failed.database</code> configuration option is unnecessary:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">failed</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> [</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">driver</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">QUEUE_FAILED_DRIVER</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">dynamodb</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">key</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_ACCESS_KEY_ID</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">secret</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_SECRET_ACCESS_KEY</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">region</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">env</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">AWS_DEFAULT_REGION</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">us-east-1</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">table</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">=&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">failed_jobs</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">],</span></div></code></pre>
</div>
<h3 id="disabling-failed-job-storage"><a href="#disabling-failed-job-storage">Disabling Failed Job Storage</a></h3>
<p>You may instruct Laravel to discard failed jobs without storing them by setting the <code>queue.failed.driver</code> configuration option's value to <code>null</code>. Typically, this may be accomplished via the <code>QUEUE_FAILED_DRIVER</code> environment variable:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="ini" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">QUEUE_FAILED_DRIVER</span><span style="color: #BFC7D5;">=null</span></div></code></pre>
</div>
<h3 id="failed-job-events"><a href="#failed-job-events">Failed Job Events</a></h3>
<p>If you would like to register an event listener that will be invoked when a job fails, you may use the <code>Queue</code> facade's <code>failing</code> method. For example, we may attach a closure to this event from the <code>boot</code> method of the <code>AppServiceProvider</code> that is included with Laravel:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Providers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Queue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\</span><span style="color: #FFCB8B;">ServiceProvider</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Events\</span><span style="color: #FFCB8B;">JobFailed</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">AppServiceProvider</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ServiceProvider</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Register any application services.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">register</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Bootstrap any application services.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">boot</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">failing</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">JobFailed</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$event</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;connectionName</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;job</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;exception</span></div><div class='line'><span style="color: #BFC7D5;">        });</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<h2 id="clearing-jobs-from-queues"><a href="#clearing-jobs-from-queues">Clearing Jobs From Queues</a></h2>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-purple-600">
        <div class="opacity-75"><svg width="28" height="40" viewBox="0 0 28 40" xmlns="http://www.w3.org/2000/svg"><title>lightbulb</title><path d="M12 28h4v-8h-4v8zM8 40h12v-8H8v8zm13.98-14.52c-1.001.705-1.661 1.545-1.98 2.52H8c-.416-.959-1.076-1.799-1.98-2.52A13.99 13.99 0 0 1 0 14C0 6.272 6.272 0 14 0s14 6.272 14 14a13.99 13.99 0 0 1-6.02 11.48z" fill="#FFF" fill-rule="nonzero"/></svg></div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
When using <a href="horizon.html">Horizon</a>, you should use the <code>horizon:clear</code> command to clear jobs from the queue instead of the <code>queue:clear</code> command.</p>
</div>
<p>If you would like to delete all jobs from the default queue of the default connection, you may do so using the <code>queue:clear</code> Artisan command:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:clear</span></div></code></pre>
</div>
<p>You may also provide the <code>connection</code> argument and <code>queue</code> option to delete jobs from a specific connection and queue:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:clear</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--queue=emails</span></div></code></pre>
</div>
<div class="mb-10 max-w-2xl mx-auto px-4 py-8 shadow-lg lg:flex lg:items-center callout">
    <div class="w-20 h-20 mb-6 flex items-center justify-center shrink-0 lg:mb-0 bg-red-600">
        <div class="opacity-75"><svg width="6" height="35" viewBox="0 0 6 35" xmlns="http://www.w3.org/2000/svg"><title>exclamation</title><path d="M0 29h6v6H0v-6zM0 0h6v24H0V0z" fill="#FFF" fill-rule="nonzero"/></svg>
</div>
    </div>
    <p class="mb-0 lg:ml-6 callout">
Clearing jobs from queues is only available for the SQS, Redis, and database queue drivers. In addition, the SQS message deletion process takes up to 60 seconds, so jobs sent to the SQS queue up to 60 seconds after you clear the queue might also be deleted.</p>
</div>
<h2 id="monitoring-your-queues"><a href="#monitoring-your-queues">Monitoring Your Queues</a></h2>
<p>If your queue receives a sudden influx of jobs, it could become overwhelmed, leading to a long wait time for jobs to complete. If you wish, Laravel can alert you when your queue job count exceeds a specified threshold.</p>
<p>To get started, you should schedule the <code>queue:monitor</code> command to <a href="scheduling.html">run every minute</a>. The command accepts the names of the queues you wish to monitor as well as your desired job count threshold:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="shell" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">php </span><span style="color: #BFC7D5;">artisan</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">queue:monitor</span><span style="color: #BFC7D5;"> </span><span style="color: #BFC7D5;">redis:default,redis:deployments</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">--max=100</span></div></code></pre>
</div>
<p>Scheduling this command alone is not enough to trigger a notification alerting you of the queue's overwhelmed status. When the command encounters a queue that has a job count exceeding your threshold, an <code>Illuminate\Queue\Events\QueueBusy</code> event will be dispatched. You may listen for this event within your application's <code>AppServiceProvider</code> in order to send a notification to you or your development team:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Notifications\</span><span style="color: #FFCB8B;">QueueHasLongWaitTime</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Events\</span><span style="color: #FFCB8B;">QueueBusy</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Event</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Notification</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;"> * Bootstrap any application services.</span></div><div class='line'><span style="color: #697098;"> </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">boot</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB6B;">Event</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">listen</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">QueueBusy</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$event</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Notification</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">route</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">mail</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">, </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;"><a href="https://laravel.com/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a3c7c6d5e3c6dbc2ced3cfc68dc0ccce">[email&#160;protected]</a></span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">)</span></div><div class='line'><span style="color: #BFC7D5;">                </span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">notify</span><span style="color: #BFC7D5;">(</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">QueueHasLongWaitTime</span><span style="color: #BFC7D5;">(</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #BEC5D4;">$event</span><span style="color: #89DDFF;">-&gt;connection</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #BEC5D4;">$event</span><span style="color: #89DDFF;">-&gt;queue</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">                    </span><span style="color: #BEC5D4;">$event</span><span style="color: #89DDFF;">-&gt;size</span></div><div class='line'><span style="color: #BFC7D5;">                ));</span></div><div class='line'><span style="color: #BFC7D5;">    });</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
</div>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>When testing code that dispatches jobs, you may wish to instruct Laravel to not actually execute the job itself, since the job's code can be tested directly and separately of the code that dispatches it. Of course, to test the job itself, you may instantiate a job instance and invoke the <code>handle</code> method directly in your test.</p>
<p>You may use the <code>Queue</code> facade's <code>fake</code> method to prevent queued jobs from actually being pushed to the queue. After calling the <code>Queue</code> facade's <code>fake</code> method, you may then assert that the application attempted to push jobs to the queue:</p>
<div class="tabbed-code" data-group="1df3cf502597c6d6b58a6e0bfc806498">
<div class="tabbed-code-nav">
<button class="tabbed-code-nav-button active" data-tab="Pest" onClick="setTab('Pest', '1df3cf502597c6d6b58a6e0bfc806498')">Pest</button>
<button class="tabbed-code-nav-button" data-tab="PHPUnit" onClick="setTab('PHPUnit', '1df3cf502597c6d6b58a6e0bfc806498')">PHPUnit</button>
</div>
<div class="tabbed-code-body">
<div class="code-container active" data-tab="Pest">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">AnotherJob</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">FinalJob</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Queue</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #82AAFF;">test</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">orders can be shipped</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #C792EA;">function</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #82AAFF;"> </span><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Perform order shipping...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert that no jobs were pushed...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertNothingPushed</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert a job was pushed to a given queue...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushedOn</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue-name</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert a job was pushed twice...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert a job was not pushed...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertNotPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">AnotherJob</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert that a Closure was pushed to the queue...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertClosurePushed</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert the total number of jobs that were pushed...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertCount</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
</div>
<div class="code-container" data-tab="PHPUnit">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> Tests\Feature;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">AnotherJob</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">FinalJob</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Queue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Tests\</span><span style="color: #FFCB8B;">TestCase</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">ExampleTest</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">TestCase</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">test_orders_can_be_shipped</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Perform order shipping...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert that no jobs were pushed...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertNothingPushed</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert a job was pushed to a given queue...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushedOn</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">queue-name</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">, </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert a job was pushed twice...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert a job was not pushed...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertNotPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">AnotherJob</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert that a Closure was pushed to the queue...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertClosurePushed</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert the total number of jobs that were pushed...</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertCount</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
</div>
</div>
</div>
<p>You may pass a closure to the <code>assertPushed</code> or <code>assertNotPushed</code> methods in order to assert that a job was pushed that passes a given &quot;truth test&quot;. If at least one job was pushed that passes the given truth test then the assertion will be successful:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #BEC5D4;">$order</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;order-&gt;id</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">===</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$order</span><span style="color: #89DDFF;">-&gt;id</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<h3 id="faking-a-subset-of-jobs"><a href="#faking-a-subset-of-jobs">Faking a Subset of Jobs</a></h3>
<p>If you only need to fake specific jobs while allowing your other jobs to execute normally, you may pass the class names of the jobs that should be faked to the <code>fake</code> method:</p>
<div class="tabbed-code" data-group="1df3cf502597c6d6b58a6e0bfc806498">
<div class="tabbed-code-nav">
<button class="tabbed-code-nav-button active" data-tab="Pest" onClick="setTab('Pest', '1df3cf502597c6d6b58a6e0bfc806498')">Pest</button>
<button class="tabbed-code-nav-button" data-tab="PHPUnit" onClick="setTab('PHPUnit', '1df3cf502597c6d6b58a6e0bfc806498')">PHPUnit</button>
</div>
<div class="tabbed-code-body">
<div class="code-container active" data-tab="Pest">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #82AAFF;">test</span><span style="color: #BFC7D5;">(</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">orders can be shipped</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #C792EA;">function</span><span style="color: #82AAFF;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #82AAFF;"> </span><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #82AAFF;">        </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #BFC7D5;">]);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Perform order shipping...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    //</span><span style="color: #697098;"> Assert a job was pushed twice...</span></div><div class='line'><span style="color: #82AAFF;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span><span style="color: #82AAFF;"> </span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
</div>
<div class="code-container" data-tab="PHPUnit">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">test_orders_can_be_shipped</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    ]);</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Perform order shipping...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">//</span><span style="color: #697098;"> Assert a job was pushed twice...</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertPushed</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">, </span><span style="color: #F78C6C;">2</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
</div>
</div>
</div>
<p>You may fake all jobs except for a set of specified jobs using the <code>except</code> method:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">()</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">except</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">]);</span></div></code></pre>
<h3 id="testing-job-chains"><a href="#testing-job-chains">Testing Job Chains</a></h3>
<p>To test job chains, you will need to utilize the <code>Bus</code> facade's faking capabilities. The <code>Bus</code> facade's <code>assertChained</code> method may be used to assert that a <a href="queues.html#job-chaining">chain of jobs</a> was dispatched. The <code>assertChained</code> method accepts an array of chained jobs as its first argument:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">RecordShipment</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">UpdateInventory</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertChained</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">RecordShipment</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">UpdateInventory</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span></div><div class='line'><span style="color: #BFC7D5;">]);</span></div></code></pre>
<p>As you can see in the example above, the array of chained jobs may be an array of the job's class names. However, you may also provide an array of actual job instances. When doing so, Laravel will ensure that the job instances are of the same class and have the same property values of the chained jobs dispatched by your application:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertChained</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">RecordShipment</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">UpdateInventory</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">]);</span></div></code></pre>
<p>You may use the <code>assertDispatchedWithoutChain</code> method to assert that a job was pushed without a chain of jobs:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertDispatchedWithoutChain</span><span style="color: #BFC7D5;">(</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #89DDFF;">::</span><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<h4 id="testing-chain-modifications"><a href="#testing-chain-modifications">Testing Chain Modifications</a></h4>
<p>If a chained job <a href="#adding-jobs-to-the-chain">prepends or appends jobs to an existing chain</a>, you may use the job's <code>assertHasChain</code> method to assert that the job has the expected chain of remaining jobs:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">handle</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertHasChain</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">TranscribePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">OptimizePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ReleasePodcast</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">]);</span></div></code></pre>
</div>
<p>The <code>assertDoesntHaveChain</code> method may be used to assert that the job's remaining chain is empty:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertDoesntHaveChain</span><span style="color: #BFC7D5;">();</span></div></code></pre>
</div>
<h4 id="testing-chained-batches"><a href="#testing-chained-batches">Testing Chained Batches</a></h4>
<p>If your job chain <a href="#chains-and-batches">contains a batch of jobs</a>, you may assert that the chained batch matches your expectations by inserting a <code>Bus::chainedBatch</code> definition within your chain assertion:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">UpdateInventory</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Bus\</span><span style="color: #FFCB8B;">PendingBatch</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertChained</span><span style="color: #BFC7D5;">([</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">chainedBatch</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">PendingBatch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;jobs-&gt;</span><span style="color: #82AAFF;">count</span><span style="color: #BFC7D5;">() </span><span style="color: #C792EA;">===</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">    }),</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">UpdateInventory</span><span style="color: #BFC7D5;">,</span></div><div class='line'><span style="color: #BFC7D5;">]);</span></div></code></pre>
<h3 id="testing-job-batches"><a href="#testing-job-batches">Testing Job Batches</a></h3>
<p>The <code>Bus</code> facade's <code>assertBatched</code> method may be used to assert that a <a href="queues.html#job-batching">batch of jobs</a> was dispatched. The closure given to the <code>assertBatched</code> method receives an instance of <code>Illuminate\Bus\PendingBatch</code>, which may be used to inspect the jobs within the batch:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Bus\</span><span style="color: #FFCB8B;">PendingBatch</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Bus</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">fake</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertBatched</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">PendingBatch</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">return</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;name</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">==</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">&#39;</span><span style="color: #C3E88D;">import-csv</span><span style="color: #D9F5DD;">&#39;</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">&amp;&amp;</span></div><div class='line'><span style="color: #BFC7D5;">           </span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;jobs-&gt;</span><span style="color: #82AAFF;">count</span><span style="color: #BFC7D5;">() </span><span style="color: #C792EA;">===</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">10</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre>
<p>You may use the <code>assertBatchCount</code> method to assert that a given number of batches were dispatched:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertBatchCount</span><span style="color: #BFC7D5;">(</span><span style="color: #F78C6C;">3</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<p>You may use <code>assertNothingBatched</code> to assert that no batches were dispatched:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #FFCB8B;">Bus</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">assertNothingBatched</span><span style="color: #BFC7D5;">();</span></div></code></pre>
<h4 id="testing-job-batch-interaction"><a href="#testing-job-batch-interaction">Testing Job / Batch Interaction</a></h4>
<p>In addition, you may occasionally need to test an individual job's interaction with its underlying batch. For example, you may need to test if a job cancelled further processing for its batch. To accomplish this, you need to assign a fake batch to the job via the <code>withFakeBatch</code> method. The <code>withFakeBatch</code> method returns a tuple containing the job instance and the fake batch:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #BFC7D5;">[</span><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;">, </span><span style="color: #BEC5D4;">$batch</span><span style="color: #BFC7D5;">] </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> (</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ShipOrder</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">withFakeBatch</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">handle</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertTrue</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">cancelled</span><span style="color: #BFC7D5;">());</span></div><div class='line'><span style="color: #FF5572;">$this</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertEmpty</span><span style="color: #BFC7D5;">(</span><span style="color: #BEC5D4;">$batch</span><span style="color: #89DDFF;">-&gt;added</span><span style="color: #BFC7D5;">);</span></div></code></pre>
<h3 id="testing-job-queue-interactions"><a href="#testing-job-queue-interactions">Testing Job / Queue Interactions</a></h3>
<p>Sometimes, you may need to test that a queued job <a href="#manually-releasing-a-job">releases itself back onto the queue</a>. Or, you may need to test that the job deleted itself. You may test these queue interactions by instantiating the job and invoking the <code>withFakeQueueInteractions</code> method.</p>
<p>Once the job's queue interactions have been faked, you may invoke the <code>handle</code> method on the job. After invoking the job, the <code>assertReleased</code>, <code>assertDeleted</code>, <code>assertNotDeleted</code>, <code>assertFailed</code>, and <code>assertNotFailed</code> methods may be used to make assertions against the job's queue interactions:</p>
<div class="code-container">
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> App\Jobs\</span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">=</span><span style="color: #BFC7D5;"> (</span><span style="color: #89DDFF;">new</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB8B;">ProcessPodcast</span><span style="color: #BFC7D5;">)</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">withFakeQueueInteractions</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">handle</span><span style="color: #BFC7D5;">();</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertReleased</span><span style="color: #BFC7D5;">(delay: </span><span style="color: #F78C6C;">30</span><span style="color: #BFC7D5;">);</span></div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertDeleted</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertNotDeleted</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertFailed</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BEC5D4;">$job</span><span style="color: #89DDFF;">-&gt;</span><span style="color: #82AAFF;">assertNotFailed</span><span style="color: #BFC7D5;">();</span></div></code></pre>
</div>
<h2 id="job-events"><a href="#job-events">Job Events</a></h2>
<p>Using the <code>before</code> and <code>after</code> methods on the <code>Queue</code> <a href="facades.html">facade</a>, you may specify callbacks to be executed before or after a queued job is processed. These callbacks are a great opportunity to perform additional logging or increment statistics for a dashboard. Typically, you should call these methods from the <code>boot</code> method of a <a href="providers.html">service provider</a>. For example, we may use the <code>AppServiceProvider</code> that is included with Laravel:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #D3423E;">&lt;?php</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">namespace</span><span style="color: #BFC7D5;"> App\Providers;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Queue</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\</span><span style="color: #FFCB8B;">ServiceProvider</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Events\</span><span style="color: #FFCB8B;">JobProcessed</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Queue\Events\</span><span style="color: #FFCB8B;">JobProcessing</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C792EA;">class</span><span style="color: #BFC7D5;"> </span><span style="color: #FFCB6B;">AppServiceProvider</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">extends</span><span style="color: #BFC7D5;"> </span><span style="color: #A9C77D;">ServiceProvider</span></div><div class='line'><span style="color: #BFC7D5;">{</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Register any application services.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">register</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #697098;">//</span><span style="color: #697098;"> ...</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #697098;">/**</span></div><div class='line'><span style="color: #697098;">     * Bootstrap any application services.</span></div><div class='line'><span style="color: #697098;">     </span><span style="color: #697098;">*/</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">public</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #82AAFF;">boot</span><span style="color: #D9F5DD;">()</span><span style="color: #89DDFF;">:</span><span style="color: #BFC7D5;"> </span><span style="color: #C792EA;">void</span></div><div class='line'><span style="color: #BFC7D5;">    {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">before</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">JobProcessing</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$event</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;connectionName</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;job</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;job-&gt;payload()</span></div><div class='line'><span style="color: #BFC7D5;">        });</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">after</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">(</span><span style="color: #FFCB8B;">JobProcessed</span><span style="color: #BFC7D5;"> </span><span style="color: #BEC5D4;">$event</span><span style="color: #D9F5DD;">)</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;connectionName</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;job</span></div><div class='line'><span style="color: #BFC7D5;">            </span><span style="color: #697098;">//</span><span style="color: #697098;"> $event-&gt;job-&gt;payload()</span></div><div class='line'><span style="color: #BFC7D5;">        });</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">}</span></div></code></pre>
<p>Using the <code>looping</code> method on the <code>Queue</code> <a href="facades.html">facade</a>, you may specify callbacks that execute before the worker attempts to fetch a job from a queue. For example, you might register a closure to rollback any transactions that were left open by a previously failed job:</p>
<pre><code data-theme="olaolu-palenight" data-lang="php" class='torchlight' style='background-color: #292D3E; --theme-selection-background: #7580B850;'><!-- Syntax highlighted by torchlight.dev --><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">DB</span><span style="color: #BFC7D5;">;</span></div><div class='line'><span style="color: #C792EA;">use</span><span style="color: #BFC7D5;"> Illuminate\Support\Facades\</span><span style="color: #FFCB8B;">Queue</span><span style="color: #BFC7D5;">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #FFCB8B;">Queue</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">looping</span><span style="color: #BFC7D5;">(</span><span style="color: #C792EA;">function</span><span style="color: #BFC7D5;"> </span><span style="color: #D9F5DD;">()</span><span style="color: #BFC7D5;"> {</span></div><div class='line'><span style="color: #BFC7D5;">    </span><span style="color: #C792EA;">while</span><span style="color: #BFC7D5;"> (</span><span style="color: #FFCB8B;">DB</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">transactionLevel</span><span style="color: #BFC7D5;">() </span><span style="color: #C792EA;">&gt;</span><span style="color: #BFC7D5;"> </span><span style="color: #F78C6C;">0</span><span style="color: #BFC7D5;">) {</span></div><div class='line'><span style="color: #BFC7D5;">        </span><span style="color: #FFCB8B;">DB</span><span style="color: #89DDFF;">::</span><span style="color: #82AAFF;">rollBack</span><span style="color: #BFC7D5;">();</span></div><div class='line'><span style="color: #BFC7D5;">    }</span></div><div class='line'><span style="color: #BFC7D5;">});</span></div></code></pre><script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
function setTab(tab, group, save) {
    save = typeof save === 'undefined' ? true : save

    document
        .querySelectorAll(`.tabbed-code[data-group="${group}"] .tabbed-code-nav-button`)
        .forEach(el => el.classList.remove('active'))
    document
        .querySelectorAll(`.tabbed-code[data-group="${group}"] .code-container`)
        .forEach(el => el.classList.remove('active'))
    document
        .querySelectorAll(`.tabbed-code[data-group="${group}"] [data-tab="${tab}"]`)
        .forEach(el => el.classList.add('active'))

    if (save) {
        saveTab(tab, group)
    }
}

function getTabs() {
    try {
        return JSON.parse(localStorage.tabs)
    } catch {
        return {}
    }
}

function saveTab(tab, group) {
    localStorage.tabs = JSON.stringify({
        ...getTabs(),
        [group]: tab,
    })
}

function restoreTabs() {
    Object.entries(getTabs()).forEach(([group, tab]) => setTab(tab, group, false))
}

restoreTabs()

</script>

                                <script async type="text/javascript" src="../../../cdn.carbonads.com/carbon83bb.js?serve=CKYILK3E&amp;placement=laravelcom" id="_carbonads_js"></script>
</div>
                        </section>
                    </section>
                </div>
            </section>
        </div>
    </div>

<footer class="relative pt-12 dark:bg-dark-700">
    <div class="max-w-screen-2xl mx-auto w-full px-8">
        <div>
            <a href="https://laravel.com/" class="inline-flex">
                <img class="w-16 h-16" src="https://laravel.com/img/logomark.min.svg" alt="Laravel" width="64" height="64" loading="lazy">
            </a>
        </div>

        <div class="mt-6 grid grid-cols-12 md:gap-x-8 gap-y-12 sm:mt-12">
            <div class="col-span-12 lg:col-span-4">
                <p class="max-w-sm text-xs text-gray-700 sm:text-sm dark:text-gray-500">
                    Laravel is a web application framework with expressive, elegant syntax. We believe development must
                    be an enjoyable and creative experience to be truly fulfilling. Laravel attempts to take the pain
                    out of development by easing common tasks used in most web projects.</p>
                <ul class="mt-6 flex items-center space-x-3">
                    <li>
                        <a href="https://x.com/laravelphp">
                            <img class="hidden dark:inline-block w-6 h-6" src="https://laravel.com/img/social/x.dark.min.svg" alt="X" width="24" height="20" loading="lazy">
                            <img class="inline-block dark:hidden w-6 h-6" src="https://laravel.com/img/social/x.min.svg" alt="X" width="24" height="20" loading="lazy">
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/laravel">
                            <img class="hidden dark:inline-block w-6 h-6"
                                src="https://laravel.com/img/social/github.dark.min.svg" alt="GitHub" width="24" height="24"
                                loading="lazy">
                            <img class="inline-block dark:hidden w-6 h-6"
                                src="https://laravel.com/img/social/github.min.svg" alt="GitHub" width="24" height="24"
                                loading="lazy">
                        </a>
                    </li>
                    <li>
                        <a href="https://discord.gg/laravel">
                            <img class="hidden dark:inline-block w-6 h-6"
                                src="https://laravel.com/img/social/discord.dark.min.svg" alt="Discord" width="21" height="24"
                                loading="lazy">
                            <img class="inline-block dark:hidden w-6 h-6"
                                src="https://laravel.com/img/social/discord.min.svg" alt="Discord" width="21" height="24"
                                loading="lazy">
                        </a>
                    </li>
                    <li>
                        <a href="https://www.youtube.com/laravelphp">
                            <img class="hidden dark:inline-block w-6 h-6"
                                src="https://laravel.com/img/social/youtube.dark.min.svg" alt="YouTube" width="169" height="150"
                                loading="lazy">
                            <img class="inline-block dark:hidden w-6 h-6"
                                src="https://laravel.com/img/social/youtube.min.svg" alt="YouTube" width="169" height="150"
                                loading="lazy">
                        </a>
                    </li>
                </ul>
            </div>
                            <div class="text-xs col-span-6 md:col-span-3 lg:col-span-2">
                    <span
                        class="uppercase dark:text-gray-200">Highlights</span>
                    <div class="mt-5">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-500">
                                                            <li>
                                    <a href="releases.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Release Notes</a>
                                </li>
                                                            <li>
                                    <a href="installation.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Getting Started</a>
                                </li>
                                                            <li>
                                    <a href="routing.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Routing</a>
                                </li>
                                                            <li>
                                    <a href="blade.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Blade Templates</a>
                                </li>
                                                            <li>
                                    <a href="authentication.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Authentication</a>
                                </li>
                                                            <li>
                                    <a href="authorization.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Authorization</a>
                                </li>
                                                            <li>
                                    <a href="artisan.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Artisan Console</a>
                                </li>
                                                            <li>
                                    <a href="database.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Database</a>
                                </li>
                                                            <li>
                                    <a href="eloquent.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Eloquent ORM</a>
                                </li>
                                                            <li>
                                    <a href="testing.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Testing</a>
                                </li>
                                                    </ul>
                    </div>
                </div>
                            <div class="text-xs col-span-6 md:col-span-3 lg:col-span-2">
                    <span
                        class="uppercase dark:text-gray-200">Resources</span>
                    <div class="mt-5">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-500">
                                                            <li>
                                    <a href="https://bootcamp.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laravel Bootcamp</a>
                                </li>
                                                            <li>
                                    <a href="https://laracasts.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laracasts</a>
                                </li>
                                                            <li>
                                    <a href="https://laravel-news.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laravel News</a>
                                </li>
                                                            <li>
                                    <a href="https://laracon.us/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laracon</a>
                                </li>
                                                            <li>
                                    <a href="https://laracon.au/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laracon AU</a>
                                </li>
                                                            <li>
                                    <a href="https://laracon.eu/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laracon EU</a>
                                </li>
                                                            <li>
                                    <a href="https://laracon.in/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Laracon India</a>
                                </li>
                                                            <li>
                                    <a href="https://larabelles.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Larabelles</a>
                                </li>
                                                            <li>
                                    <a href="https://laravel.com/careers"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Careers</a>
                                </li>
                                                            <li>
                                    <a href="https://larajobs.com/?partner=5"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Jobs</a>
                                </li>
                                                            <li>
                                    <a href="https://laracasts.com/discuss"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Forums</a>
                                </li>
                                                            <li>
                                    <a href="https://laravel.com/trademark"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Trademark</a>
                                </li>
                                                    </ul>
                    </div>
                </div>
                            <div class="text-xs col-span-6 md:col-span-3 lg:col-span-2">
                    <span
                        class="uppercase dark:text-gray-200">Partners</span>
                    <div class="mt-5">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-500">
                                                            <li>
                                    <a href="https://vehikl.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Vehikl</a>
                                </li>
                                                            <li>
                                    <a href="https://webreinvent.com/?utm_source=laravel&amp;utm_medium=laravel.com&amp;utm_campaign=footer-link"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">WebReinvent</a>
                                </li>
                                                            <li>
                                    <a href="https://tighten.co/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Tighten</a>
                                </li>
                                                            <li>
                                    <a href="https://www.bacancytechnology.com/hire-laravel-developer?utm_source=laravel&amp;utm_medium=partners.laravel&amp;utm_campaign=sponsors"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Bacancy</a>
                                </li>
                                                            <li>
                                    <a href="https://64robots.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">64 Robots</a>
                                </li>
                                                            <li>
                                    <a href="https://activelogic.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Active Logic</a>
                                </li>
                                                            <li>
                                    <a href="https://www.blackairplane.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Black Airplane</a>
                                </li>
                                                            <li>
                                    <a href="https://www.byte5.net/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Byte 5</a>
                                </li>
                                                            <li>
                                    <a href="https://www.curotec.com/services/technologies/laravel/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Curotec</a>
                                </li>
                                                            <li>
                                    <a href="https://www.cyber-duck.co.uk/how-we-work/technology/laravel?utm_source=Laravel%20Partner&amp;utm_medium=Sponsorship"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Cyber-Duck</a>
                                </li>
                                                            <li>
                                    <a href="https://devsquad.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">DevSquad</a>
                                </li>
                                                            <li>
                                    <a href="https://jump24.co.uk/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Jump24</a>
                                </li>
                                                            <li>
                                    <a href="https://kirschbaumdevelopment.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Kirschbaum</a>
                                </li>
                                                    </ul>
                    </div>
                </div>
                            <div class="text-xs col-span-6 md:col-span-3 lg:col-span-2">
                    <span
                        class="uppercase dark:text-gray-200">Ecosystem</span>
                    <div class="mt-5">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-500">
                                                            <li>
                                    <a href="starter-kits.html#laravel-breeze"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Breeze</a>
                                </li>
                                                            <li>
                                    <a href="billing.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Cashier</a>
                                </li>
                                                            <li>
                                    <a href="dusk.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Dusk</a>
                                </li>
                                                            <li>
                                    <a href="broadcasting.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Echo</a>
                                </li>
                                                            <li>
                                    <a href="https://envoyer.io/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Envoyer</a>
                                </li>
                                                            <li>
                                    <a href="https://forge.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Forge</a>
                                </li>
                                                            <li>
                                    <a href="https://herd.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Herd</a>
                                </li>
                                                            <li>
                                    <a href="horizon.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Horizon</a>
                                </li>
                                                            <li>
                                    <a href="https://inertiajs.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Inertia</a>
                                </li>
                                                            <li>
                                    <a href="https://jetstream.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Jetstream</a>
                                </li>
                                                            <li>
                                    <a href="https://livewire.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Livewire</a>
                                </li>
                                                            <li>
                                    <a href="https://nova.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Nova</a>
                                </li>
                                                            <li>
                                    <a href="octane.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Octane</a>
                                </li>
                                                            <li>
                                    <a href="pennant.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Pennant</a>
                                </li>
                                                            <li>
                                    <a href="pint.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Pint</a>
                                </li>
                                                            <li>
                                    <a href="prompts.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Prompts</a>
                                </li>
                                                            <li>
                                    <a href="https://pulse.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Pulse</a>
                                </li>
                                                            <li>
                                    <a href="https://reverb.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Reverb</a>
                                </li>
                                                            <li>
                                    <a href="sail.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Sail</a>
                                </li>
                                                            <li>
                                    <a href="sanctum.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Sanctum</a>
                                </li>
                                                            <li>
                                    <a href="scout.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Scout</a>
                                </li>
                                                            <li>
                                    <a href="socialite.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Socialite</a>
                                </li>
                                                            <li>
                                    <a href="https://spark.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Spark</a>
                                </li>
                                                            <li>
                                    <a href="telescope.html"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Telescope</a>
                                </li>
                                                            <li>
                                    <a href="https://vapor.laravel.com/"
                                        class="transition-colors hover:text-gray-600 dark:hover:text-gray-400">Vapor</a>
                                </li>
                                                    </ul>
                    </div>
                </div>
                    </div>
        <div class="mt-10 border-t pt-6 pb-16 border-gray-200 dark:border-dark-500">
            <p class="text-xs text-gray-700 dark:text-gray-400">
                Laravel is a Trademark of Laravel Holdings Inc.<br />
                Copyright &copy; 2011-2024 Laravel Holdings Inc.
            </p>
            <p class="mt-6 text-xs text-gray-700 dark:text-gray-400">
                Code highlighting provided by <a href="https://torchlight.dev/">Torchlight</a>
            </p>
        </div>
    </div>
</footer>

<script>
    var algolia_app_id = 'E3MIRNPJH5';
    var algolia_search_key = '1fa3a8fec06eb1858d6ca137211225c0';
    var version = '11.x';
</script>

<script>
    var _gaq=[['_setAccount','UA-23865777-1'],['_trackPageview']];
    (function(d,t){
        var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)
    }(document,'script'));
</script>

<!-- HubSpot -->
<script type="text/javascript" id="hs-script-loader" async defer src="../../../js-na1.hs-scripts.com/45240648.js"></script>

<div class="fixed">
    <input type="text">
</div>

</body>

<!-- Mirrored from laravel.com/docs/11.x/queues by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2024 03:14:16 GMT -->
</html>
